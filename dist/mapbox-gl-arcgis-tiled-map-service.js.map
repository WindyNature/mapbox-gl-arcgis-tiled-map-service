{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/@mapbox/point-geometry/index.js","node_modules/@mapbox/sphericalmercator/sphericalmercator.js","node_modules/@mapbox/unitbezier/index.js","node_modules/mapbox-gl/src/geo/coordinate.js","node_modules/mapbox-gl/src/geo/lng_lat.js","node_modules/mapbox-gl/src/geo/lng_lat_bounds.js","node_modules/mapbox-gl/src/render/texture.js","node_modules/mapbox-gl/src/source/tile_bounds.js","node_modules/mapbox-gl/src/util/ajax.js","node_modules/mapbox-gl/src/util/browser.js","node_modules/mapbox-gl/src/util/browser/window.js","node_modules/mapbox-gl/src/util/evented.js","node_modules/mapbox-gl/src/util/util.js","src/arcgis_tiled_map_service_source.js","src/helpers.js","src/index.js","src/load_arcgis_mapserver.js"],"names":["Point","x","y","this","module","exports","prototype","clone","add","p","_add","sub","_sub","multByPoint","_multByPoint","divByPoint","_divByPoint","mult","k","_mult","div","_div","rotate","a","_rotate","rotateAround","_rotateAround","matMult","m","_matMult","unit","_unit","perp","_perp","round","_round","mag","Math","sqrt","equals","other","dist","distSqr","dx","dy","angle","atan2","angleTo","b","angleWith","angleWithSep","cos","sin","convert","Array","isArray","SphericalMercator","isFloat","n","Number","options","size","cache","c","Bc","Cc","zc","Ac","d","push","PI","D2R","R2D","A","MAXEXTENT","px","ll","zoom","pow","bc","cc","ac","f","min","max","log","g","lon","lat","atan","exp","bbox","tms_style","srs","ur","concat","xyz","px_ll","px_ur","floor","bounds","minX","apply","minY","maxX","maxY","tms","to","forward","slice","inverse","xy","tan","UnitBezier","p1x","p1y","p2x","p2y","cx","bx","ax","cy","by","ay","sampleCurveX","t","sampleCurveY","sampleCurveDerivativeX","solveCurveX","epsilon","t0","t1","t2","x2","i","abs","d2","solve","Coordinate","column","row","zoomTo","_zoomTo","scale","const","wrap","require","LngLat","lng","isNaN","Error","toArray","toString","toBounds","radius","latAccuracy","lngAccuracy","input","length","LngLatBounds","sw","ne","setSouthWest","setNorthEast","_ne","_sw","extend","obj","sw2","ne2","every","getCenter","getSouthWest","getNorthEast","getNorthWest","getWest","getNorth","getSouthEast","getEast","getSouth","ref","HTMLImageElement","HTMLCanvasElement","HTMLVideoElement","ImageData","Texture","context","image","format","premultiply","width","height","texture","gl","createTexture","update","bindTexture","TEXTURE_2D","pixelStoreUnpack","set","RGBA","pixelStoreUnpackPremultiplyAlpha","texImage2D","UNSIGNED_BYTE","data","bind","filter","minFilter","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","destroy","deleteTexture","clamp","TileBounds","minzoom","maxzoom","validateBounds","contains","tileID","level","lngX","z","latY","ceil","makeRequest","requestParameters","xhr","window","XMLHttpRequest","open","url","headers","setRequestHeader","withCredentials","credentials","sameOrigin","document","createElement","href","protocol","location","host","ResourceType","Unknown","Style","Source","Tile","Glyphs","SpriteImage","SpriteJSON","Image","Object","freeze","AJAXError","message","status","super","call","create","constructor","getJSON","callback","onerror","statusText","onload","response","let","JSON","parse","err","send","getArrayBuffer","responseType","byteLength","cacheControl","getResponseHeader","expires","transparentPngUrl","getImage","imgData","img","URL","webkitURL","revokeObjectURL","src","blob","Blob","Uint8Array","type","createObjectURL","getVideo","urls","video","onloadstart","s","crossOrigin","appendChild","now","performance","Date","frame","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancel","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","fn","cancelFrame","id","getImageData","canvas","getContext","drawImage","hardwareConcurrency","navigator","devicePixelRatio","supportsWebp","webpImgTest","self","_addEventListener","listener","listenerList","_removeEventListener","index","indexOf","splice","util","Evented","on","_listeners","off","_oneTimeListeners","once","fire","this$1","listens","target","listeners","list","oneTimeListeners","i$1","list$1","listener$1","_eventedParent","_eventedParentData","endsWith","console","error","setEventedParent","parent","easeCubicInOut","t3","bezier","ease","w","asyncAll","array","remaining","results","forEach","item","result","values","keysDifference","difference","dest","sources","len","arguments","pick","properties","uniqueId","bindAll","fns","getCoordinatesCenter","coords","Infinity","dMax","LN2","string","suffix","mapObject","iterator","output","key","filterObject","deepEqual","keys","map","arraysIntersect","l","warnOnceHistory","warnOnce","warn","isCounterClockwise","calculateSignedArea","ring","sum","j","p1","p2","isClosedPolygon","points","sphericalToCartesian","r","azimuthal","polar","parseCacheControl","header","replace","$0","$1","$2","$3","value","toLowerCase","maxAge","parseInt","ajax","loadArcGISMapServer","helpers","ArcGISTiledMapServiceSource","dispatcher","eventedParent","roundZoom","tileSize","_loaded","_options","load","dataType","metadata","tileBounds","sourceDataType","onAdd","baseUrl","split","tileUrl","RegExp","test","subdomains","token","serialize","hasTile","canonical","loadTile","tile","tilePoint","overscaledZ","_template","_getSubdomain","_lodMap","request","aborted","state","_refreshExpiredTiles","setExpiryData","painter","getTileTexture","LINEAR","CLAMP_TO_EDGE","LINEAR_MIPMAP_NEAREST","texSubImage2D","extTextureFilterAnisotropic","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","extTextureFilterAnisotropicMax","generateMipmap","abortTile","abort","unloadTile","saveTileTexture","hasTransition","_templateRe","str","undefined","browser","MercatorZoomLevels","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","_withinPercentage","percentage","loaded","sr","spatialReference","latestWkid","wkid","extent","fullExtent","boundsWebMercator","xmin","ymin","xmax","ymax","merc","boundsWGS84","arcgisLODs","tileInfo","lods","correctResolutions","arcgisLOD","ci","correctRes","resolution"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nmodule.exports = Point;\n\n/**\n * A standalone point geometry with useful accessor, comparison, and\n * modification methods.\n *\n * @class Point\n * @param {Number} x the x-coordinate. this could be longitude or screen\n * pixels, or any other sort of unit.\n * @param {Number} y the y-coordinate. this could be latitude or screen\n * pixels, or any other sort of unit.\n * @example\n * var point = new Point(-77, 38);\n */\nfunction Point(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nPoint.prototype = {\n\n    /**\n     * Clone this point, returning a new point that can be modified\n     * without affecting the old one.\n     * @return {Point} the clone\n     */\n    clone: function() { return new Point(this.x, this.y); },\n\n    /**\n     * Add this point's x & y coordinates to another point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    add:     function(p) { return this.clone()._add(p); },\n\n    /**\n     * Subtract this point's x & y coordinates to from point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    sub:     function(p) { return this.clone()._sub(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    multByPoint:    function(p) { return this.clone()._multByPoint(p); },\n\n    /**\n     * Divide this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    divByPoint:     function(p) { return this.clone()._divByPoint(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {Point} k factor\n     * @return {Point} output point\n     */\n    mult:    function(k) { return this.clone()._mult(k); },\n\n    /**\n     * Divide this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {Point} k factor\n     * @return {Point} output point\n     */\n    div:     function(k) { return this.clone()._div(k); },\n\n    /**\n     * Rotate this point around the 0, 0 origin by an angle a,\n     * given in radians\n     * @param {Number} a angle to rotate around, in radians\n     * @return {Point} output point\n     */\n    rotate:  function(a) { return this.clone()._rotate(a); },\n\n    /**\n     * Rotate this point around p point by an angle a,\n     * given in radians\n     * @param {Number} a angle to rotate around, in radians\n     * @param {Point} p Point to rotate around\n     * @return {Point} output point\n     */\n    rotateAround:  function(a,p) { return this.clone()._rotateAround(a,p); },\n\n    /**\n     * Multiply this point by a 4x1 transformation matrix\n     * @param {Array<Number>} m transformation matrix\n     * @return {Point} output point\n     */\n    matMult: function(m) { return this.clone()._matMult(m); },\n\n    /**\n     * Calculate this point but as a unit vector from 0, 0, meaning\n     * that the distance from the resulting point to the 0, 0\n     * coordinate will be equal to 1 and the angle from the resulting\n     * point to the 0, 0 coordinate will be the same as before.\n     * @return {Point} unit vector point\n     */\n    unit:    function() { return this.clone()._unit(); },\n\n    /**\n     * Compute a perpendicular point, where the new y coordinate\n     * is the old x coordinate and the new x coordinate is the old y\n     * coordinate multiplied by -1\n     * @return {Point} perpendicular point\n     */\n    perp:    function() { return this.clone()._perp(); },\n\n    /**\n     * Return a version of this point with the x & y coordinates\n     * rounded to integers.\n     * @return {Point} rounded point\n     */\n    round:   function() { return this.clone()._round(); },\n\n    /**\n     * Return the magitude of this point: this is the Euclidean\n     * distance from the 0, 0 coordinate to this point's x and y\n     * coordinates.\n     * @return {Number} magnitude\n     */\n    mag: function() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n\n    /**\n     * Judge whether this point is equal to another point, returning\n     * true or false.\n     * @param {Point} other the other point\n     * @return {boolean} whether the points are equal\n     */\n    equals: function(other) {\n        return this.x === other.x &&\n               this.y === other.y;\n    },\n\n    /**\n     * Calculate the distance from this point to another point\n     * @param {Point} p the other point\n     * @return {Number} distance\n     */\n    dist: function(p) {\n        return Math.sqrt(this.distSqr(p));\n    },\n\n    /**\n     * Calculate the distance from this point to another point,\n     * without the square root step. Useful if you're comparing\n     * relative distances.\n     * @param {Point} p the other point\n     * @return {Number} distance\n     */\n    distSqr: function(p) {\n        var dx = p.x - this.x,\n            dy = p.y - this.y;\n        return dx * dx + dy * dy;\n    },\n\n    /**\n     * Get the angle from the 0, 0 coordinate to this point, in radians\n     * coordinates.\n     * @return {Number} angle\n     */\n    angle: function() {\n        return Math.atan2(this.y, this.x);\n    },\n\n    /**\n     * Get the angle from this point to another point, in radians\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleTo: function(b) {\n        return Math.atan2(this.y - b.y, this.x - b.x);\n    },\n\n    /**\n     * Get the angle between this point and another point, in radians\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleWith: function(b) {\n        return this.angleWithSep(b.x, b.y);\n    },\n\n    /*\n     * Find the angle of the two vectors, solving the formula for\n     * the cross product a x b = |a||b|sin(θ) for θ.\n     * @param {Number} x the x-coordinate\n     * @param {Number} y the y-coordinate\n     * @return {Number} the angle in radians\n     */\n    angleWithSep: function(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    },\n\n    _matMult: function(m) {\n        var x = m[0] * this.x + m[1] * this.y,\n            y = m[2] * this.x + m[3] * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _add: function(p) {\n        this.x += p.x;\n        this.y += p.y;\n        return this;\n    },\n\n    _sub: function(p) {\n        this.x -= p.x;\n        this.y -= p.y;\n        return this;\n    },\n\n    _mult: function(k) {\n        this.x *= k;\n        this.y *= k;\n        return this;\n    },\n\n    _div: function(k) {\n        this.x /= k;\n        this.y /= k;\n        return this;\n    },\n\n    _multByPoint: function(p) {\n        this.x *= p.x;\n        this.y *= p.y;\n        return this;\n    },\n\n    _divByPoint: function(p) {\n        this.x /= p.x;\n        this.y /= p.y;\n        return this;\n    },\n\n    _unit: function() {\n        this._div(this.mag());\n        return this;\n    },\n\n    _perp: function() {\n        var y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    },\n\n    _rotate: function(angle) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _rotateAround: function(angle, p) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = p.x + cos * (this.x - p.x) - sin * (this.y - p.y),\n            y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _round: function() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    }\n};\n\n/**\n * Construct a point from an array if necessary, otherwise if the input\n * is already a Point, or an unknown type, return it unchanged\n * @param {Array<Number>|Point|*} a any kind of input value\n * @return {Point} constructed point, or passed-through value.\n * @example\n * // this\n * var point = Point.convert([0, 1]);\n * // is equivalent to\n * var point = new Point(0, 1);\n */\nPoint.convert = function (a) {\n    if (a instanceof Point) {\n        return a;\n    }\n    if (Array.isArray(a)) {\n        return new Point(a[0], a[1]);\n    }\n    return a;\n};\n","var SphericalMercator = (function(){\n\n// Closures including constants and other precalculated values.\nvar cache = {},\n    EPSLN = 1.0e-10,\n    D2R = Math.PI / 180,\n    R2D = 180 / Math.PI,\n    // 900913 properties.\n    A = 6378137.0,\n    MAXEXTENT = 20037508.342789244;\n\nfunction isFloat(n){\n    return Number(n) === n && n % 1 !== 0;\n}\n\n// SphericalMercator constructor: precaches calculations\n// for fast tile lookups.\nfunction SphericalMercator(options) {\n    options = options || {};\n    this.size = options.size || 256;\n    if (!cache[this.size]) {\n        var size = this.size;\n        var c = cache[this.size] = {};\n        c.Bc = [];\n        c.Cc = [];\n        c.zc = [];\n        c.Ac = [];\n        for (var d = 0; d < 30; d++) {\n            c.Bc.push(size / 360);\n            c.Cc.push(size / (2 * Math.PI));\n            c.zc.push(size / 2);\n            c.Ac.push(size);\n            size *= 2;\n        }\n    }\n    this.Bc = cache[this.size].Bc;\n    this.Cc = cache[this.size].Cc;\n    this.zc = cache[this.size].zc;\n    this.Ac = cache[this.size].Ac;\n};\n\n// Convert lon lat to screen pixel value\n//\n// - `ll` {Array} `[lon, lat]` array of geographic coordinates.\n// - `zoom` {Number} zoom level.\nSphericalMercator.prototype.px = function(ll, zoom) {\n  if (isFloat(zoom)) {\n    var size = this.size * Math.pow(2, zoom);\n    var d = size / 2;\n    var bc = (size / 360);\n    var cc = (size / (2 * Math.PI));\n    var ac = size;\n    var f = Math.min(Math.max(Math.sin(D2R * ll[1]), -0.9999), 0.9999);\n    var x = d + ll[0] * bc;\n    var y = d + 0.5 * Math.log((1 + f) / (1 - f)) * -cc;\n    (x > ac) && (x = ac);\n    (y > ac) && (y = ac);\n    //(x < 0) && (x = 0);\n    //(y < 0) && (y = 0);\n    return [x, y];\n  } else {\n    var d = this.zc[zoom];\n    var f = Math.min(Math.max(Math.sin(D2R * ll[1]), -0.9999), 0.9999);\n    var x = Math.round(d + ll[0] * this.Bc[zoom]);\n    var y = Math.round(d + 0.5 * Math.log((1 + f) / (1 - f)) * (-this.Cc[zoom]));\n    (x > this.Ac[zoom]) && (x = this.Ac[zoom]);\n    (y > this.Ac[zoom]) && (y = this.Ac[zoom]);\n    //(x < 0) && (x = 0);\n    //(y < 0) && (y = 0);\n    return [x, y];\n  }\n};\n\n// Convert screen pixel value to lon lat\n//\n// - `px` {Array} `[x, y]` array of geographic coordinates.\n// - `zoom` {Number} zoom level.\nSphericalMercator.prototype.ll = function(px, zoom) {\n  if (isFloat(zoom)) {\n    var size = this.size * Math.pow(2, zoom);\n    var bc = (size / 360);\n    var cc = (size / (2 * Math.PI));\n    var zc = size / 2;\n    var g = (px[1] - zc) / -cc;\n    var lon = (px[0] - zc) / bc;\n    var lat = R2D * (2 * Math.atan(Math.exp(g)) - 0.5 * Math.PI);\n    return [lon, lat];\n  } else {\n    var g = (px[1] - this.zc[zoom]) / (-this.Cc[zoom]);\n    var lon = (px[0] - this.zc[zoom]) / this.Bc[zoom];\n    var lat = R2D * (2 * Math.atan(Math.exp(g)) - 0.5 * Math.PI);\n    return [lon, lat];\n  }\n};\n\n// Convert tile xyz value to bbox of the form `[w, s, e, n]`\n//\n// - `x` {Number} x (longitude) number.\n// - `y` {Number} y (latitude) number.\n// - `zoom` {Number} zoom.\n// - `tms_style` {Boolean} whether to compute using tms-style.\n// - `srs` {String} projection for resulting bbox (WGS84|900913).\n// - `return` {Array} bbox array of values in form `[w, s, e, n]`.\nSphericalMercator.prototype.bbox = function(x, y, zoom, tms_style, srs) {\n    // Convert xyz into bbox with srs WGS84\n    if (tms_style) {\n        y = (Math.pow(2, zoom) - 1) - y;\n    }\n    // Use +y to make sure it's a number to avoid inadvertent concatenation.\n    var ll = [x * this.size, (+y + 1) * this.size]; // lower left\n    // Use +x to make sure it's a number to avoid inadvertent concatenation.\n    var ur = [(+x + 1) * this.size, y * this.size]; // upper right\n    var bbox = this.ll(ll, zoom).concat(this.ll(ur, zoom));\n\n    // If web mercator requested reproject to 900913.\n    if (srs === '900913') {\n        return this.convert(bbox, '900913');\n    } else {\n        return bbox;\n    }\n};\n\n// Convert bbox to xyx bounds\n//\n// - `bbox` {Number} bbox in the form `[w, s, e, n]`.\n// - `zoom` {Number} zoom.\n// - `tms_style` {Boolean} whether to compute using tms-style.\n// - `srs` {String} projection of input bbox (WGS84|900913).\n// - `@return` {Object} XYZ bounds containing minX, maxX, minY, maxY properties.\nSphericalMercator.prototype.xyz = function(bbox, zoom, tms_style, srs) {\n    // If web mercator provided reproject to WGS84.\n    if (srs === '900913') {\n        bbox = this.convert(bbox, 'WGS84');\n    }\n\n    var ll = [bbox[0], bbox[1]]; // lower left\n    var ur = [bbox[2], bbox[3]]; // upper right\n    var px_ll = this.px(ll, zoom);\n    var px_ur = this.px(ur, zoom);\n    // Y = 0 for XYZ is the top hence minY uses px_ur[1].\n    var x = [ Math.floor(px_ll[0] / this.size), Math.floor((px_ur[0] - 1) / this.size) ];\n    var y = [ Math.floor(px_ur[1] / this.size), Math.floor((px_ll[1] - 1) / this.size) ];\n    var bounds = {\n        minX: Math.min.apply(Math, x) < 0 ? 0 : Math.min.apply(Math, x),\n        minY: Math.min.apply(Math, y) < 0 ? 0 : Math.min.apply(Math, y),\n        maxX: Math.max.apply(Math, x),\n        maxY: Math.max.apply(Math, y)\n    };\n    if (tms_style) {\n        var tms = {\n            minY: (Math.pow(2, zoom) - 1) - bounds.maxY,\n            maxY: (Math.pow(2, zoom) - 1) - bounds.minY\n        };\n        bounds.minY = tms.minY;\n        bounds.maxY = tms.maxY;\n    }\n    return bounds;\n};\n\n// Convert projection of given bbox.\n//\n// - `bbox` {Number} bbox in the form `[w, s, e, n]`.\n// - `to` {String} projection of output bbox (WGS84|900913). Input bbox\n//   assumed to be the \"other\" projection.\n// - `@return` {Object} bbox with reprojected coordinates.\nSphericalMercator.prototype.convert = function(bbox, to) {\n    if (to === '900913') {\n        return this.forward(bbox.slice(0, 2)).concat(this.forward(bbox.slice(2,4)));\n    } else {\n        return this.inverse(bbox.slice(0, 2)).concat(this.inverse(bbox.slice(2,4)));\n    }\n};\n\n// Convert lon/lat values to 900913 x/y.\nSphericalMercator.prototype.forward = function(ll) {\n    var xy = [\n        A * ll[0] * D2R,\n        A * Math.log(Math.tan((Math.PI*0.25) + (0.5 * ll[1] * D2R)))\n    ];\n    // if xy value is beyond maxextent (e.g. poles), return maxextent.\n    (xy[0] > MAXEXTENT) && (xy[0] = MAXEXTENT);\n    (xy[0] < -MAXEXTENT) && (xy[0] = -MAXEXTENT);\n    (xy[1] > MAXEXTENT) && (xy[1] = MAXEXTENT);\n    (xy[1] < -MAXEXTENT) && (xy[1] = -MAXEXTENT);\n    return xy;\n};\n\n// Convert 900913 x/y values to lon/lat.\nSphericalMercator.prototype.inverse = function(xy) {\n    return [\n        (xy[0] * R2D / A),\n        ((Math.PI*0.5) - 2.0 * Math.atan(Math.exp(-xy[1] / A))) * R2D\n    ];\n};\n\nreturn SphericalMercator;\n\n})();\n\nif (typeof module !== 'undefined' && typeof exports !== 'undefined') {\n    module.exports = exports = SphericalMercator;\n}\n","/*\n * Copyright (C) 2008 Apple Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Ported from Webkit\n * http://svn.webkit.org/repository/webkit/trunk/Source/WebCore/platform/graphics/UnitBezier.h\n */\n\nmodule.exports = UnitBezier;\n\nfunction UnitBezier(p1x, p1y, p2x, p2y) {\n    // Calculate the polynomial coefficients, implicit first and last control points are (0,0) and (1,1).\n    this.cx = 3.0 * p1x;\n    this.bx = 3.0 * (p2x - p1x) - this.cx;\n    this.ax = 1.0 - this.cx - this.bx;\n\n    this.cy = 3.0 * p1y;\n    this.by = 3.0 * (p2y - p1y) - this.cy;\n    this.ay = 1.0 - this.cy - this.by;\n\n    this.p1x = p1x;\n    this.p1y = p2y;\n    this.p2x = p2x;\n    this.p2y = p2y;\n}\n\nUnitBezier.prototype.sampleCurveX = function(t) {\n    // `ax t^3 + bx t^2 + cx t' expanded using Horner's rule.\n    return ((this.ax * t + this.bx) * t + this.cx) * t;\n};\n\nUnitBezier.prototype.sampleCurveY = function(t) {\n    return ((this.ay * t + this.by) * t + this.cy) * t;\n};\n\nUnitBezier.prototype.sampleCurveDerivativeX = function(t) {\n    return (3.0 * this.ax * t + 2.0 * this.bx) * t + this.cx;\n};\n\nUnitBezier.prototype.solveCurveX = function(x, epsilon) {\n    if (typeof epsilon === 'undefined') epsilon = 1e-6;\n\n    var t0, t1, t2, x2, i;\n\n    // First try a few iterations of Newton's method -- normally very fast.\n    for (t2 = x, i = 0; i < 8; i++) {\n\n        x2 = this.sampleCurveX(t2) - x;\n        if (Math.abs(x2) < epsilon) return t2;\n\n        var d2 = this.sampleCurveDerivativeX(t2);\n        if (Math.abs(d2) < 1e-6) break;\n\n        t2 = t2 - x2 / d2;\n    }\n\n    // Fall back to the bisection method for reliability.\n    t0 = 0.0;\n    t1 = 1.0;\n    t2 = x;\n\n    if (t2 < t0) return t0;\n    if (t2 > t1) return t1;\n\n    while (t0 < t1) {\n\n        x2 = this.sampleCurveX(t2);\n        if (Math.abs(x2 - x) < epsilon) return t2;\n\n        if (x > x2) {\n            t0 = t2;\n        } else {\n            t1 = t2;\n        }\n\n        t2 = (t1 - t0) * 0.5 + t0;\n    }\n\n    // Failure.\n    return t2;\n};\n\nUnitBezier.prototype.solve = function(x, epsilon) {\n    return this.sampleCurveY(this.solveCurveX(x, epsilon));\n};\n","//      \n\n/**\n * A coordinate is a column, row, zoom combination, often used\n * as the data component of a tile.\n *\n * @param {number} column\n * @param {number} row\n * @param {number} zoom\n * @private\n */\nclass Coordinate {\n                   \n                \n                 \n    constructor(column        , row        , zoom        ) {\n        this.column = column;\n        this.row = row;\n        this.zoom = zoom;\n    }\n\n    /**\n     * Create a clone of this coordinate that can be mutated without\n     * changing the original coordinate\n     *\n     * @returns {Coordinate} clone\n     * @private\n     * var coord = new Coordinate(0, 0, 0);\n     * var c2 = coord.clone();\n     * // since coord is cloned, modifying a property of c2 does\n     * // not modify it.\n     * c2.zoom = 2;\n     */\n    clone() {\n        return new Coordinate(this.column, this.row, this.zoom);\n    }\n\n    /**\n     * Zoom this coordinate to a given zoom level. This returns a new\n     * coordinate object, not mutating the old one.\n     *\n     * @param {number} zoom\n     * @returns {Coordinate} zoomed coordinate\n     * @private\n     * @example\n     * var coord = new Coordinate(0, 0, 0);\n     * var c2 = coord.zoomTo(1);\n     * c2 // equals new Coordinate(0, 0, 1);\n     */\n    zoomTo(zoom        ) { return this.clone()._zoomTo(zoom); }\n\n    /**\n     * Subtract the column and row values of this coordinate from those\n     * of another coordinate. The other coordinat will be zoomed to the\n     * same level as `this` before the subtraction occurs\n     *\n     * @param {Coordinate} c other coordinate\n     * @returns {Coordinate} result\n     * @private\n     */\n    sub(c            ) { return this.clone()._sub(c); }\n\n    _zoomTo(zoom        ) {\n        const scale = Math.pow(2, zoom - this.zoom);\n        this.column *= scale;\n        this.row *= scale;\n        this.zoom = zoom;\n        return this;\n    }\n\n    _sub(c            ) {\n        c = c.zoomTo(this.zoom);\n        this.column -= c.column;\n        this.row -= c.row;\n        return this;\n    }\n}\n\nmodule.exports = Coordinate;\n","//      \n\nconst wrap = require('../util/util').wrap;\n\n/**\n * A `LngLat` object represents a given longitude and latitude coordinate, measured in degrees.\n *\n * Mapbox GL uses longitude, latitude coordinate order (as opposed to latitude, longitude) to match GeoJSON.\n *\n * Note that any Mapbox GL method that accepts a `LngLat` object as an argument or option\n * can also accept an `Array` of two numbers and will perform an implicit conversion.\n * This flexible type is documented as {@link LngLatLike}.\n *\n * @param {number} lng Longitude, measured in degrees.\n * @param {number} lat Latitude, measured in degrees.\n * @example\n * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n * @see [Get coordinates of the mouse pointer](https://www.mapbox.com/mapbox-gl-js/example/mouse-position/)\n * @see [Display a popup](https://www.mapbox.com/mapbox-gl-js/example/popup/)\n * @see [Highlight features within a bounding box](https://www.mapbox.com/mapbox-gl-js/example/using-box-queryrenderedfeatures/)\n * @see [Create a timeline animation](https://www.mapbox.com/mapbox-gl-js/example/timeline-animation/)\n */\nclass LngLat {\n                \n                \n\n    constructor(lng        , lat        ) {\n        if (isNaN(lng) || isNaN(lat)) {\n            throw new Error(`Invalid LngLat object: (${lng}, ${lat})`);\n        }\n        this.lng = +lng;\n        this.lat = +lat;\n        if (this.lat > 90 || this.lat < -90) {\n            throw new Error('Invalid LngLat latitude value: must be between -90 and 90');\n        }\n    }\n\n    /**\n     * Returns a new `LngLat` object whose longitude is wrapped to the range (-180, 180).\n     *\n     * @returns {LngLat} The wrapped `LngLat` object.\n     * @example\n     * var ll = new mapboxgl.LngLat(286.0251, 40.7736);\n     * var wrapped = ll.wrap();\n     * wrapped.lng; // = -73.9749\n     */\n    wrap() {\n        return new LngLat(wrap(this.lng, -180, 180), this.lat);\n    }\n\n    /**\n     * Returns the coordinates represented as an array of two numbers.\n     *\n     * @returns {Array<number>} The coordinates represeted as an array of longitude and latitude.\n     * @example\n     * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n     * ll.toArray(); // = [-73.9749, 40.7736]\n     */\n    toArray() {\n        return [this.lng, this.lat];\n    }\n\n    /**\n     * Returns the coordinates represent as a string.\n     *\n     * @returns {string} The coordinates represented as a string of the format `'LngLat(lng, lat)'`.\n     * @example\n     * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n     * ll.toString(); // = \"LngLat(-73.9749, 40.7736)\"\n     */\n    toString() {\n        return `LngLat(${this.lng}, ${this.lat})`;\n    }\n\n    /**\n     * Returns a `LngLatBounds` from the coordinates extended by a given `radius`.\n     *\n     * @param {number} radius Distance in meters from the coordinates to extend the bounds.\n     * @returns {LngLatBounds} A new `LngLatBounds` object representing the coordinates extended by the `radius`.\n     * @example\n     * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n     * ll.toBounds(100).toArray(); // = [[-73.97501862141328, 40.77351016847229], [-73.97478137858673, 40.77368983152771]]\n     */\n    toBounds(radius        ) {\n        const earthCircumferenceInMetersAtEquator = 40075017;\n        const latAccuracy = 360 * radius / earthCircumferenceInMetersAtEquator,\n            lngAccuracy = latAccuracy / Math.cos((Math.PI / 180) * this.lat);\n\n        const LngLatBounds = require('./lng_lat_bounds');\n        return new LngLatBounds(new LngLat(this.lng - lngAccuracy, this.lat - latAccuracy),\n            new LngLat(this.lng + lngAccuracy, this.lat + latAccuracy));\n    }\n\n    /**\n     * Converts an array of two numbers to a `LngLat` object.\n     *\n     * If a `LngLat` object is passed in, the function returns it unchanged.\n     *\n     * @param {LngLatLike} input An array of two numbers to convert, or a `LngLat` object to return.\n     * @returns {LngLat} A new `LngLat` object, if a conversion occurred, or the original `LngLat` object.\n     * @example\n     * var arr = [-73.9749, 40.7736];\n     * var ll = mapboxgl.LngLat.convert(arr);\n     * ll;   // = LngLat {lng: -73.9749, lat: 40.7736}\n     */\n    static convert(input            )         {\n        if (input instanceof LngLat) {\n            return input;\n        }\n        if (Array.isArray(input) && (input.length === 2 || input.length === 3)) {\n            return new LngLat(Number(input[0]), Number(input[1]));\n        }\n        if (!Array.isArray(input) && typeof input === 'object' && input !== null) {\n            return new LngLat(Number(input.lng), Number(input.lat));\n        }\n        throw new Error(\"`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]\");\n    }\n}\n\n/**\n * A {@link LngLat} object, an array of two numbers representing longitude and latitude,\n * or an object with `lng` and `lat` properties.\n *\n * @typedef {LngLat | {lng: number, lat: number} | [number, number]} LngLatLike\n * @example\n * var v1 = new mapboxgl.LngLat(-122.420679, 37.772537);\n * var v2 = [-122.420679, 37.772537];\n */\n                                                                                \n\nmodule.exports = LngLat;\n","//      \n\nconst LngLat = require('./lng_lat');\n\n                                          \n\n/**\n * A `LngLatBounds` object represents a geographical bounding box,\n * defined by its southwest and northeast points in longitude and latitude.\n *\n * If no arguments are provided to the constructor, a `null` bounding box is created.\n *\n * Note that any Mapbox GL method that accepts a `LngLatBounds` object as an argument or option\n * can also accept an `Array` of two {@link LngLatLike} constructs and will perform an implicit conversion.\n * This flexible type is documented as {@link LngLatBoundsLike}.\n *\n * @param {LngLatLike} [sw] The southwest corner of the bounding box.\n * @param {LngLatLike} [ne] The northeast corner of the bounding box.\n * @example\n * var sw = new mapboxgl.LngLat(-73.9876, 40.7661);\n * var ne = new mapboxgl.LngLat(-73.9397, 40.8002);\n * var llb = new mapboxgl.LngLatBounds(sw, ne);\n */\nclass LngLatBounds {\n                \n                \n\n    // This constructor is too flexible to type. It should not be so flexible.\n    constructor(sw     , ne     ) {\n        if (!sw) {\n            return;\n        } else if (ne) {\n            this.setSouthWest(sw).setNorthEast(ne);\n        } else if (sw.length === 4) {\n            this.setSouthWest([sw[0], sw[1]]).setNorthEast([sw[2], sw[3]]);\n        } else {\n            this.setSouthWest(sw[0]).setNorthEast(sw[1]);\n        }\n    }\n\n    /**\n     * Set the northeast corner of the bounding box\n     *\n     * @param {LngLatLike} ne\n     * @returns {LngLatBounds} `this`\n     */\n    setNorthEast(ne            ) {\n        this._ne = ne instanceof LngLat ? new LngLat(ne.lng, ne.lat) : LngLat.convert(ne);\n        return this;\n    }\n\n    /**\n     * Set the southwest corner of the bounding box\n     *\n     * @param {LngLatLike} sw\n     * @returns {LngLatBounds} `this`\n     */\n    setSouthWest(sw            ) {\n        this._sw = sw instanceof LngLat ? new LngLat(sw.lng, sw.lat) : LngLat.convert(sw);\n        return this;\n    }\n\n    /**\n     * Extend the bounds to include a given LngLat or LngLatBounds.\n     *\n     * @param {LngLat|LngLatBounds} obj object to extend to\n     * @returns {LngLatBounds} `this`\n     */\n    extend(obj) {\n        const sw = this._sw,\n            ne = this._ne;\n        let sw2, ne2;\n\n        if (obj instanceof LngLat) {\n            sw2 = obj;\n            ne2 = obj;\n\n        } else if (obj instanceof LngLatBounds) {\n            sw2 = obj._sw;\n            ne2 = obj._ne;\n\n            if (!sw2 || !ne2) return this;\n\n        } else {\n            if (Array.isArray(obj)) {\n                if (obj.every(Array.isArray)) {\n                    return this.extend(LngLatBounds.convert(obj));\n                } else {\n                    return this.extend(LngLat.convert(obj));\n                }\n            }\n            return this;\n        }\n\n        if (!sw && !ne) {\n            this._sw = new LngLat(sw2.lng, sw2.lat);\n            this._ne = new LngLat(ne2.lng, ne2.lat);\n\n        } else {\n            sw.lng = Math.min(sw2.lng, sw.lng);\n            sw.lat = Math.min(sw2.lat, sw.lat);\n            ne.lng = Math.max(ne2.lng, ne.lng);\n            ne.lat = Math.max(ne2.lat, ne.lat);\n        }\n\n        return this;\n    }\n\n    /**\n     * Returns the geographical coordinate equidistant from the bounding box's corners.\n     *\n     * @returns {LngLat} The bounding box's center.\n     * @example\n     * var llb = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002]);\n     * llb.getCenter(); // = LngLat {lng: -73.96365, lat: 40.78315}\n     */\n    getCenter()         {\n        return new LngLat((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2);\n    }\n\n    /**\n     * Returns the southwest corner of the bounding box.\n     *\n     * @returns {LngLat} The southwest corner of the bounding box.\n     */\n    getSouthWest()         { return this._sw; }\n\n    /**\n    * Returns the northeast corner of the bounding box.\n    *\n    * @returns {LngLat} The northeast corner of the bounding box.\n     */\n    getNorthEast()         { return this._ne; }\n\n    /**\n    * Returns the northwest corner of the bounding box.\n    *\n    * @returns {LngLat} The northwest corner of the bounding box.\n     */\n    getNorthWest()         { return new LngLat(this.getWest(), this.getNorth()); }\n\n    /**\n    * Returns the southeast corner of the bounding box.\n    *\n    * @returns {LngLat} The southeast corner of the bounding box.\n     */\n    getSouthEast()         { return new LngLat(this.getEast(), this.getSouth()); }\n\n    /**\n    * Returns the west edge of the bounding box.\n    *\n    * @returns {number} The west edge of the bounding box.\n     */\n    getWest()         { return this._sw.lng; }\n\n    /**\n    * Returns the south edge of the bounding box.\n    *\n    * @returns {number} The south edge of the bounding box.\n     */\n    getSouth()         { return this._sw.lat; }\n\n    /**\n    * Returns the east edge of the bounding box.\n    *\n    * @returns {number} The east edge of the bounding box.\n     */\n    getEast()         { return this._ne.lng; }\n\n    /**\n    * Returns the north edge of the bounding box.\n    *\n    * @returns {number} The north edge of the bounding box.\n     */\n    getNorth()         { return this._ne.lat; }\n\n    /**\n     * Returns the bounding box represented as an array.\n     *\n     * @returns {Array<Array<number>>} The bounding box represented as an array, consisting of the\n     *   southwest and northeast coordinates of the bounding represented as arrays of numbers.\n     * @example\n     * var llb = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002]);\n     * llb.toArray(); // = [[-73.9876, 40.7661], [-73.9397, 40.8002]]\n     */\n    toArray() {\n        return [this._sw.toArray(), this._ne.toArray()];\n    }\n\n    /**\n     * Return the bounding box represented as a string.\n     *\n     * @returns {string} The bounding box represents as a string of the format\n     *   `'LngLatBounds(LngLat(lng, lat), LngLat(lng, lat))'`.\n     * @example\n     * var llb = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002]);\n     * llb.toString(); // = \"LngLatBounds(LngLat(-73.9876, 40.7661), LngLat(-73.9397, 40.8002))\"\n     */\n    toString() {\n        return `LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`;\n    }\n\n    /**\n     * Converts an array to a `LngLatBounds` object.\n     *\n     * If a `LngLatBounds` object is passed in, the function returns it unchanged.\n     *\n     * Internally, the function calls `LngLat#convert` to convert arrays to `LngLat` values.\n     *\n     * @param {LngLatBoundsLike} input An array of two coordinates to convert, or a `LngLatBounds` object to return.\n     * @returns {LngLatBounds} A new `LngLatBounds` object, if a conversion occurred, or the original `LngLatBounds` object.\n     * @example\n     * var arr = [[-73.9876, 40.7661], [-73.9397, 40.8002]];\n     * var llb = mapboxgl.LngLatBounds.convert(arr);\n     * llb;   // = LngLatBounds {_sw: LngLat {lng: -73.9876, lat: 40.7661}, _ne: LngLat {lng: -73.9397, lat: 40.8002}}\n     */\n    static convert(input                  )               {\n        if (!input || input instanceof LngLatBounds) return input;\n        return new LngLatBounds(input);\n    }\n}\n\n/**\n * A {@link LngLatBounds} object, an array of {@link LngLatLike} objects in [sw, ne] order,\n * or an array of numbers in [west, south, east, north] order.\n *\n * @typedef {LngLatBounds | [LngLatLike, LngLatLike] | [number, number, number, number]} LngLatBoundsLike\n * @example\n * var v1 = new mapboxgl.LngLatBounds(\n *   new mapboxgl.LngLat(-73.9876, 40.7661),\n *   new mapboxgl.LngLat(-73.9397, 40.8002)\n * );\n * var v2 = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002])\n * var v3 = [[-73.9876, 40.7661], [-73.9397, 40.8002]];\n */\n                                                                                                          \n\nmodule.exports = LngLatBounds;\n","//      \n\nconst {HTMLImageElement, HTMLCanvasElement, HTMLVideoElement, ImageData} = require('../util/window');\n\n                                         \n                                                         \n\n                           \n                                                  \n                                                    \n                           \n                                                    \n                                                                   \n                                                      \n                         \n                                                    \n                                                           \n                                                              \n\n                   \n                  \n                   \n              \n \n\n                          \n               \n                \n                      \n                       \n                      \n               \n                 \n\nclass Texture {\n                     \n                        \n                          \n                          \n                           \n                       \n\n    constructor(context         , image              , format               , premultiply          ) {\n        this.context = context;\n\n        const {width, height} = image;\n        this.size = [width, height];\n        this.format = format;\n\n        this.texture = context.gl.createTexture();\n        this.update(image, premultiply);\n    }\n\n    update(image              , premultiply          ) {\n        const {width, height} = image;\n        this.size = [width, height];\n\n        const {context} = this;\n        const {gl} = context;\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n        context.pixelStoreUnpack.set(1);\n\n        if (this.format === gl.RGBA && premultiply !== false) {\n            context.pixelStoreUnpackPremultiplyAlpha.set(true);\n        }\n\n        if (image instanceof HTMLImageElement || image instanceof HTMLCanvasElement || image instanceof HTMLVideoElement || image instanceof ImageData) {\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.format, gl.UNSIGNED_BYTE, image);\n        } else {\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, gl.UNSIGNED_BYTE, image.data);\n        }\n    }\n\n    bind(filter               , wrap             , minFilter                ) {\n        const {context} = this;\n        const {gl} = context;\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n\n        if (filter !== this.filter) {\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter || filter);\n            this.filter = filter;\n        }\n\n        if (wrap !== this.wrap) {\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrap);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrap);\n            this.wrap = wrap;\n        }\n    }\n\n    destroy() {\n        const {gl} = this.context;\n        gl.deleteTexture(this.texture);\n        this.texture = (null     );\n    }\n}\n\nmodule.exports = Texture;\n","//      \n\nconst LngLatBounds = require('../geo/lng_lat_bounds');\nconst clamp = require('../util/util').clamp;\n\n                                               \n\nclass TileBounds {\n                         \n                    \n                    \n\n    constructor(bounds                                  , minzoom         , maxzoom         ) {\n        this.bounds = LngLatBounds.convert(this.validateBounds(bounds));\n        this.minzoom = minzoom || 0;\n        this.maxzoom = maxzoom || 24;\n    }\n\n    validateBounds(bounds                                  ) {\n        // make sure the bounds property contains valid longitude and latitudes\n        if (!Array.isArray(bounds) || bounds.length !== 4) return [-180, -90, 180, 90];\n        return [Math.max(-180, bounds[0]), Math.max(-90, bounds[1]), Math.min(180, bounds[2]), Math.min(90, bounds[3])];\n    }\n\n    contains(tileID                 ) {\n        const level = {\n            minX: Math.floor(this.lngX(this.bounds.getWest(), tileID.z)),\n            minY: Math.floor(this.latY(this.bounds.getNorth(), tileID.z)),\n            maxX: Math.ceil(this.lngX(this.bounds.getEast(), tileID.z)),\n            maxY: Math.ceil(this.latY(this.bounds.getSouth(), tileID.z))\n        };\n        const hit = tileID.x >= level.minX && tileID.x < level.maxX && tileID.y >= level.minY && tileID.y < level.maxY;\n        return hit;\n    }\n\n    lngX(lng        , zoom        ) {\n        return (lng + 180) * (Math.pow(2, zoom) / 360);\n    }\n\n    latY(lat        , zoom        ) {\n        const f = clamp(Math.sin(Math.PI / 180 * lat), -0.9999, 0.9999);\n        const scale = Math.pow(2, zoom) / (2 * Math.PI);\n        return Math.pow(2, zoom - 1) + 0.5 * Math.log((1 + f) / (1 - f)) * -scale;\n    }\n}\n\nmodule.exports = TileBounds;\n","//      \n\nconst window = require('./window');\n\n                                                  \n\n/**\n * The type of a resource.\n * @private\n * @readonly\n * @enum {string}\n */\nconst ResourceType = {\n    Unknown: 'Unknown',\n    Style: 'Style',\n    Source: 'Source',\n    Tile: 'Tile',\n    Glyphs: 'Glyphs',\n    SpriteImage: 'SpriteImage',\n    SpriteJSON: 'SpriteJSON',\n    Image: 'Image'\n};\nexports.ResourceType = ResourceType;\n\nif (typeof Object.freeze == 'function') {\n    Object.freeze(ResourceType);\n}\n\n/**\n * A `RequestParameters` object to be returned from Map.options.transformRequest callbacks.\n * @typedef {Object} RequestParameters\n * @property {string} url The URL to be requested.\n * @property {Object} headers The headers to be sent with the request.\n * @property {string} credentials `'same-origin'|'include'` Use 'include' to send cookies with cross-origin requests.\n */\n                                 \n                \n                     \n                                           \n  \n\nclass AJAXError extends Error {\n                   \n    constructor(message        , status        ) {\n        super(message);\n        this.status = status;\n    }\n}\n\nfunction makeRequest(requestParameters                   )                 {\n    const xhr                 = new window.XMLHttpRequest();\n\n    xhr.open('GET', requestParameters.url, true);\n    for (const k in requestParameters.headers) {\n        xhr.setRequestHeader(k, requestParameters.headers[k]);\n    }\n    xhr.withCredentials = requestParameters.credentials === 'include';\n    return xhr;\n}\n\nexports.getJSON = function(requestParameters                   , callback                 ) {\n    const xhr = makeRequest(requestParameters);\n    xhr.setRequestHeader('Accept', 'application/json');\n    xhr.onerror = function() {\n        callback(new Error(xhr.statusText));\n    };\n    xhr.onload = function() {\n        if (xhr.status >= 200 && xhr.status < 300 && xhr.response) {\n            let data;\n            try {\n                data = JSON.parse(xhr.response);\n            } catch (err) {\n                return callback(err);\n            }\n            callback(null, data);\n        } else {\n            callback(new AJAXError(xhr.statusText, xhr.status));\n        }\n    };\n    xhr.send();\n    return xhr;\n};\n\nexports.getArrayBuffer = function(requestParameters                   , callback                                                                        ) {\n    const xhr = makeRequest(requestParameters);\n    xhr.responseType = 'arraybuffer';\n    xhr.onerror = function() {\n        callback(new Error(xhr.statusText));\n    };\n    xhr.onload = function() {\n        const response              = xhr.response;\n        if (response.byteLength === 0 && xhr.status === 200) {\n            return callback(new Error('http status 200 returned without content.'));\n        }\n        if (xhr.status >= 200 && xhr.status < 300 && xhr.response) {\n            callback(null, {\n                data: response,\n                cacheControl: xhr.getResponseHeader('Cache-Control'),\n                expires: xhr.getResponseHeader('Expires')\n            });\n        } else {\n            callback(new AJAXError(xhr.statusText, xhr.status));\n        }\n    };\n    xhr.send();\n    return xhr;\n};\n\nfunction sameOrigin(url) {\n    const a                    = window.document.createElement('a');\n    a.href = url;\n    return a.protocol === window.document.location.protocol && a.host === window.document.location.host;\n}\n\nconst transparentPngUrl = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=';\n\nexports.getImage = function(requestParameters                   , callback                            ) {\n    // request the image with XHR to work around caching issues\n    // see https://github.com/mapbox/mapbox-gl-js/issues/1470\n    return exports.getArrayBuffer(requestParameters, (err, imgData) => {\n        if (err) {\n            callback(err);\n        } else if (imgData) {\n            const img                   = new window.Image();\n            const URL = window.URL || window.webkitURL;\n            img.onload = () => {\n                callback(null, img);\n                URL.revokeObjectURL(img.src);\n            };\n            const blob       = new window.Blob([new Uint8Array(imgData.data)], { type: 'image/png' });\n            (img     ).cacheControl = imgData.cacheControl;\n            (img     ).expires = imgData.expires;\n            img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : transparentPngUrl;\n        }\n    });\n};\n\nexports.getVideo = function(urls               , callback                            ) {\n    const video                   = window.document.createElement('video');\n    video.onloadstart = function() {\n        callback(null, video);\n    };\n    for (let i = 0; i < urls.length; i++) {\n        const s                    = window.document.createElement('source');\n        if (!sameOrigin(urls[i])) {\n            video.crossOrigin = 'Anonymous';\n        }\n        s.src = urls[i];\n        video.appendChild(s);\n    }\n    return video;\n};\n","//      \n\nconst window = require('./window');\n\nconst now = window.performance && window.performance.now ?\n    window.performance.now.bind(window.performance) :\n    Date.now.bind(Date);\n\nconst frame = window.requestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.msRequestAnimationFrame;\n\nconst cancel = window.cancelAnimationFrame ||\n    window.mozCancelAnimationFrame ||\n    window.webkitCancelAnimationFrame ||\n    window.msCancelAnimationFrame;\n\n/**\n * @private\n */\nmodule.exports = {\n    /**\n     * Provides a function that outputs milliseconds: either performance.now()\n     * or a fallback to Date.now()\n     */\n    now,\n\n    frame(fn          ) {\n        return frame(fn);\n    },\n\n    cancelFrame(id        ) {\n        return cancel(id);\n    },\n\n    getImageData(img                   )            {\n        const canvas = window.document.createElement('canvas');\n        const context = canvas.getContext('2d');\n        if (!context) {\n            throw new Error('failed to create canvas 2d context');\n        }\n        canvas.width = img.width;\n        canvas.height = img.height;\n        context.drawImage(img, 0, 0, img.width, img.height);\n        return context.getImageData(0, 0, img.width, img.height);\n    },\n\n    hardwareConcurrency: window.navigator.hardwareConcurrency || 4,\n\n    get devicePixelRatio() { return window.devicePixelRatio; },\n\n    supportsWebp: false\n};\n\nconst webpImgTest = window.document.createElement('img');\nwebpImgTest.onload = function() {\n    module.exports.supportsWebp = true;\n};\nwebpImgTest.src = 'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=';\n","//      \n\n/* eslint-env browser */\nmodule.exports = (self        );\n","//      \n\nconst util = require('./util');\n\n                                \n                                               \n\nfunction _addEventListener(type        , listener          , listenerList           ) {\n    listenerList[type] = listenerList[type] || [];\n    listenerList[type].push(listener);\n}\n\nfunction _removeEventListener(type        , listener          , listenerList           ) {\n    if (listenerList && listenerList[type]) {\n        const index = listenerList[type].indexOf(listener);\n        if (index !== -1) {\n            listenerList[type].splice(index, 1);\n        }\n    }\n}\n\n/**\n * Methods mixed in to other classes for event capabilities.\n *\n * @mixin Evented\n */\nclass Evented {\n                          \n                                 \n                             \n                                                 \n\n    /**\n     * Adds a listener to a specified event type.\n     *\n     * @param {string} type The event type to add a listen for.\n     * @param {Function} listener The function to be called when the event is fired.\n     *   The listener function is called with the data object passed to `fire`,\n     *   extended with `target` and `type` properties.\n     * @returns {Object} `this`\n     */\n    on(type   , listener          )       {\n        this._listeners = this._listeners || {};\n        _addEventListener(type, listener, this._listeners);\n\n        return this;\n    }\n\n    /**\n     * Removes a previously registered event listener.\n     *\n     * @param {string} type The event type to remove listeners for.\n     * @param {Function} listener The listener function to remove.\n     * @returns {Object} `this`\n     */\n    off(type   , listener          ) {\n        _removeEventListener(type, listener, this._listeners);\n        _removeEventListener(type, listener, this._oneTimeListeners);\n\n        return this;\n    }\n\n    /**\n     * Adds a listener that will be called only once to a specified event type.\n     *\n     * The listener will be called first time the event fires after the listener is registered.\n     *\n     * @param {string} type The event type to listen for.\n     * @param {Function} listener The function to be called when the event is fired the first time.\n     * @returns {Object} `this`\n     */\n    once(type        , listener          ) {\n        this._oneTimeListeners = this._oneTimeListeners || {};\n        _addEventListener(type, listener, this._oneTimeListeners);\n\n        return this;\n    }\n\n    /**\n     * Fires an event of the specified type.\n     *\n     * @param {string} type The type of event to fire.\n     * @param {Object} [data] Data to be passed to any listeners.\n     * @returns {Object} `this`\n     */\n    fire(type        , data         ) {\n        if (this.listens(type)) {\n            data = util.extend({}, data, {type: type, target: this});\n\n            // make sure adding or removing listeners inside other listeners won't cause an infinite loop\n            const listeners = this._listeners && this._listeners[type] ? this._listeners[type].slice() : [];\n            for (const listener of listeners) {\n                listener.call(this, data);\n            }\n\n            const oneTimeListeners = this._oneTimeListeners && this._oneTimeListeners[type] ? this._oneTimeListeners[type].slice() : [];\n            for (const listener of oneTimeListeners) {\n                _removeEventListener(type, listener, this._oneTimeListeners);\n                listener.call(this, data);\n            }\n\n            if (this._eventedParent) {\n                this._eventedParent.fire(type, util.extend({}, data, typeof this._eventedParentData === 'function' ? this._eventedParentData() : this._eventedParentData));\n            }\n\n        // To ensure that no error events are dropped, print them to the\n        // console if they have no listeners.\n        } else if (util.endsWith(type, 'error')) {\n            console.error((data && data.error) || data || 'Empty error event');\n        }\n\n        return this;\n    }\n\n    /**\n     * Returns a true if this instance of Evented or any forwardeed instances of Evented have a listener for the specified type.\n     *\n     * @param {string} type The event type\n     * @returns {boolean} `true` if there is at least one registered listener for specified event type, `false` otherwise\n     */\n    listens(type        ) {\n        return (\n            (this._listeners && this._listeners[type] && this._listeners[type].length > 0) ||\n            (this._oneTimeListeners && this._oneTimeListeners[type] && this._oneTimeListeners[type].length > 0) ||\n            (this._eventedParent && this._eventedParent.listens(type))\n        );\n    }\n\n    /**\n     * Bubble all events fired by this instance of Evented to this parent instance of Evented.\n     *\n     * @private\n     * @returns {Object} `this`\n     */\n    setEventedParent(parent          , data                        ) {\n        this._eventedParent = parent;\n        this._eventedParentData = data;\n\n        return this;\n    }\n}\n\nmodule.exports = Evented;\n","//      \n\nconst UnitBezier = require('@mapbox/unitbezier');\nconst Coordinate = require('../geo/coordinate');\nconst Point = require('@mapbox/point-geometry');\n\n                                                \n\n/**\n * @module util\n * @private\n */\n\n/**\n * Given a value `t` that varies between 0 and 1, return\n * an interpolation function that eases between 0 and 1 in a pleasing\n * cubic in-out fashion.\n *\n * @private\n */\nexports.easeCubicInOut = function(t        )         {\n    if (t <= 0) return 0;\n    if (t >= 1) return 1;\n    const t2 = t * t,\n        t3 = t2 * t;\n    return 4 * (t < 0.5 ? t3 : 3 * (t - t2) + t3 - 0.75);\n};\n\n/**\n * Given given (x, y), (x1, y1) control points for a bezier curve,\n * return a function that interpolates along that curve.\n *\n * @param p1x control point 1 x coordinate\n * @param p1y control point 1 y coordinate\n * @param p2x control point 2 x coordinate\n * @param p2y control point 2 y coordinate\n * @private\n */\nexports.bezier = function(p1x        , p1y        , p2x        , p2y        )                        {\n    const bezier = new UnitBezier(p1x, p1y, p2x, p2y);\n    return function(t        ) {\n        return bezier.solve(t);\n    };\n};\n\n/**\n * A default bezier-curve powered easing function with\n * control points (0.25, 0.1) and (0.25, 1)\n *\n * @private\n */\nexports.ease = exports.bezier(0.25, 0.1, 0.25, 1);\n\n/**\n * constrain n to the given range via min + max\n *\n * @param n value\n * @param min the minimum value to be returned\n * @param max the maximum value to be returned\n * @returns the clamped value\n * @private\n */\nexports.clamp = function (n        , min        , max        )         {\n    return Math.min(max, Math.max(min, n));\n};\n\n/**\n * constrain n to the given range, excluding the minimum, via modular arithmetic\n *\n * @param n value\n * @param min the minimum value to be returned, exclusive\n * @param max the maximum value to be returned, inclusive\n * @returns constrained number\n * @private\n */\nexports.wrap = function (n        , min        , max        )         {\n    const d = max - min;\n    const w = ((n - min) % d + d) % d + min;\n    return (w === min) ? max : w;\n};\n\n/*\n * Call an asynchronous function on an array of arguments,\n * calling `callback` with the completed results of all calls.\n *\n * @param array input to each call of the async function.\n * @param fn an async function with signature (data, callback)\n * @param callback a callback run after all async work is done.\n * called with an array, containing the results of each async call.\n * @private\n */\nexports.asyncAll = function               (\n    array             ,\n    fn                                                    ,\n    callback                         \n) {\n    if (!array.length) { return callback(null, []); }\n    let remaining = array.length;\n    const results = new Array(array.length);\n    let error = null;\n    array.forEach((item, i) => {\n        fn(item, (err, result) => {\n            if (err) error = err;\n            results[i] = ((result     )        ); // https://github.com/facebook/flow/issues/2123\n            if (--remaining === 0) callback(error, results);\n        });\n    });\n};\n\n/*\n * Polyfill for Object.values. Not fully spec compliant, but we don't\n * need it to be.\n *\n * @private\n */\nexports.values = function   (obj                    )           {\n    const result = [];\n    for (const k in obj) {\n        result.push(obj[k]);\n    }\n    return result;\n};\n\n/*\n * Compute the difference between the keys in one object and the keys\n * in another object.\n *\n * @returns keys difference\n * @private\n */\nexports.keysDifference = function      (obj                    , other                    )                {\n    const difference = [];\n    for (const i in obj) {\n        if (!(i in other)) {\n            difference.push(i);\n        }\n    }\n    return difference;\n};\n\n/**\n * Given a destination object and optionally many source objects,\n * copy all properties from the source objects into the destination.\n * The last source object given overrides properties from previous\n * source objects.\n *\n * @param dest destination object\n * @param sources sources from which properties are pulled\n * @private\n */\nexports.extend = function (dest        , ...sources                )         {\n    for (const src of sources) {\n        for (const k in src) {\n            dest[k] = src[k];\n        }\n    }\n    return dest;\n};\n\n/**\n * Given an object and a number of properties as strings, return version\n * of that object with only those properties.\n *\n * @param src the object\n * @param properties an array of property names chosen\n * to appear on the resulting object.\n * @returns object with limited properties.\n * @example\n * var foo = { name: 'Charlie', age: 10 };\n * var justName = pick(foo, ['name']);\n * // justName = { name: 'Charlie' }\n * @private\n */\nexports.pick = function (src        , properties               )         {\n    const result = {};\n    for (let i = 0; i < properties.length; i++) {\n        const k = properties[i];\n        if (k in src) {\n            result[k] = src[k];\n        }\n    }\n    return result;\n};\n\nlet id = 1;\n\n/**\n * Return a unique numeric id, starting at 1 and incrementing with\n * each call.\n *\n * @returns unique numeric id.\n * @private\n */\nexports.uniqueId = function ()         {\n    return id++;\n};\n\n/**\n * Given an array of member function names as strings, replace all of them\n * with bound versions that will always refer to `context` as `this`. This\n * is useful for classes where otherwise event bindings would reassign\n * `this` to the evented object or some other value: this lets you ensure\n * the `this` value always.\n *\n * @param fns list of member function names\n * @param context the context value\n * @example\n * function MyClass() {\n *   bindAll(['ontimer'], this);\n *   this.name = 'Tom';\n * }\n * MyClass.prototype.ontimer = function() {\n *   alert(this.name);\n * };\n * var myClass = new MyClass();\n * setTimeout(myClass.ontimer, 100);\n * @private\n */\nexports.bindAll = function(fns               , context        )       {\n    fns.forEach((fn) => {\n        if (!context[fn]) { return; }\n        context[fn] = context[fn].bind(context);\n    });\n};\n\n/**\n * Given a list of coordinates, get their center as a coordinate.\n *\n * @returns centerpoint\n * @private\n */\nexports.getCoordinatesCenter = function(coords                   )             {\n    let minX = Infinity;\n    let minY = Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n\n    for (let i = 0; i < coords.length; i++) {\n        minX = Math.min(minX, coords[i].column);\n        minY = Math.min(minY, coords[i].row);\n        maxX = Math.max(maxX, coords[i].column);\n        maxY = Math.max(maxY, coords[i].row);\n    }\n\n    const dx = maxX - minX;\n    const dy = maxY - minY;\n    const dMax = Math.max(dx, dy);\n    const zoom = Math.max(0, Math.floor(-Math.log(dMax) / Math.LN2));\n    return new Coordinate((minX + maxX) / 2, (minY + maxY) / 2, 0)\n        .zoomTo(zoom);\n};\n\n/**\n * Determine if a string ends with a particular substring\n *\n * @private\n */\nexports.endsWith = function(string        , suffix        )          {\n    return string.indexOf(suffix, string.length - suffix.length) !== -1;\n};\n\n/**\n * Create an object by mapping all the values of an existing object while\n * preserving their keys.\n *\n * @private\n */\nexports.mapObject = function(input        , iterator          , context         )         {\n    const output = {};\n    for (const key in input) {\n        output[key] = iterator.call(context || this, input[key], key, input);\n    }\n    return output;\n};\n\n/**\n * Create an object by filtering out values of an existing object.\n *\n * @private\n */\nexports.filterObject = function(input        , iterator          , context         )         {\n    const output = {};\n    for (const key in input) {\n        if (iterator.call(context || this, input[key], key, input)) {\n            output[key] = input[key];\n        }\n    }\n    return output;\n};\n\n/**\n * Deeply compares two object literals.\n *\n * @private\n */\nexports.deepEqual = function(a        , b        )          {\n    if (Array.isArray(a)) {\n        if (!Array.isArray(b) || a.length !== b.length) return false;\n        for (let i = 0; i < a.length; i++) {\n            if (!exports.deepEqual(a[i], b[i])) return false;\n        }\n        return true;\n    }\n    if (typeof a === 'object' && a !== null && b !== null) {\n        if (!(typeof b === 'object')) return false;\n        const keys = Object.keys(a);\n        if (keys.length !== Object.keys(b).length) return false;\n        for (const key in a) {\n            if (!exports.deepEqual(a[key], b[key])) return false;\n        }\n        return true;\n    }\n    return a === b;\n};\n\n/**\n * Deeply clones two objects.\n *\n * @private\n */\nexports.clone = function   (input   )    {\n    if (Array.isArray(input)) {\n        return input.map(exports.clone);\n    } else if (typeof input === 'object' && input) {\n        return ((exports.mapObject(input, exports.clone)     )   );\n    } else {\n        return input;\n    }\n};\n\n/**\n * Check if two arrays have at least one common element.\n *\n * @private\n */\nexports.arraysIntersect = function   (a          , b          )          {\n    for (let l = 0; l < a.length; l++) {\n        if (b.indexOf(a[l]) >= 0) return true;\n    }\n    return false;\n};\n\n/**\n * Print a warning message to the console and ensure duplicate warning messages\n * are not printed.\n *\n * @private\n */\nconst warnOnceHistory                           = {};\nexports.warnOnce = function(message        )       {\n    if (!warnOnceHistory[message]) {\n        // console isn't defined in some WebWorkers, see #2558\n        if (typeof console !== \"undefined\") console.warn(message);\n        warnOnceHistory[message] = true;\n    }\n};\n\n/**\n * Indicates if the provided Points are in a counter clockwise (true) or clockwise (false) order\n *\n * @returns true for a counter clockwise set of points\n */\n// http://bryceboe.com/2006/10/23/line-segment-intersection-algorithm/\nexports.isCounterClockwise = function(a       , b       , c       )          {\n    return (c.y - a.y) * (b.x - a.x) > (b.y - a.y) * (c.x - a.x);\n};\n\n/**\n * Returns the signed area for the polygon ring.  Postive areas are exterior rings and\n * have a clockwise winding.  Negative areas are interior rings and have a counter clockwise\n * ordering.\n *\n * @param ring Exterior or interior ring\n */\nexports.calculateSignedArea = function(ring              )         {\n    let sum = 0;\n    for (let i = 0, len = ring.length, j = len - 1, p1, p2; i < len; j = i++) {\n        p1 = ring[i];\n        p2 = ring[j];\n        sum += (p2.x - p1.x) * (p1.y + p2.y);\n    }\n    return sum;\n};\n\n/**\n * Detects closed polygons, first + last point are equal\n *\n * @param points array of points\n * @return true if the points are a closed polygon\n */\nexports.isClosedPolygon = function(points              )          {\n    // If it is 2 points that are the same then it is a point\n    // If it is 3 points with start and end the same then it is a line\n    if (points.length < 4)\n        return false;\n\n    const p1 = points[0];\n    const p2 = points[points.length - 1];\n\n    if (Math.abs(p1.x - p2.x) > 0 ||\n        Math.abs(p1.y - p2.y) > 0) {\n        return false;\n    }\n\n    // polygon simplification can produce polygons with zero area and more than 3 points\n    return (Math.abs(exports.calculateSignedArea(points)) > 0.01);\n};\n\n/**\n * Converts spherical coordinates to cartesian coordinates.\n *\n * @param spherical Spherical coordinates, in [radial, azimuthal, polar]\n * @return cartesian coordinates in [x, y, z]\n */\n\nexports.sphericalToCartesian = function([r, azimuthal, polar]                          )                                    {\n    // We abstract \"north\"/\"up\" (compass-wise) to be 0° when really this is 90° (π/2):\n    // correct for that here\n    azimuthal += 90;\n\n    // Convert azimuthal and polar angles to radians\n    azimuthal *= Math.PI / 180;\n    polar *= Math.PI / 180;\n\n    return {\n        x: r * Math.cos(azimuthal) * Math.sin(polar),\n        y: r * Math.sin(azimuthal) * Math.sin(polar),\n        z: r * Math.cos(polar)\n    };\n};\n\n/**\n * Parses data from 'Cache-Control' headers.\n *\n * @param cacheControl Value of 'Cache-Control' header\n * @return object containing parsed header info.\n */\n\nexports.parseCacheControl = function(cacheControl        )         {\n    // Taken from [Wreck](https://github.com/hapijs/wreck)\n    const re = /(?:^|(?:\\s*\\,\\s*))([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)(?:\\=(?:([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)|(?:\\\"((?:[^\"\\\\]|\\\\.)*)\\\")))?/g;\n\n    const header = {};\n    cacheControl.replace(re, ($0, $1, $2, $3) => {\n        const value = $2 || $3;\n        header[$1] = value ? value.toLowerCase() : true;\n        return '';\n    });\n\n    if (header['max-age']) {\n        const maxAge = parseInt(header['max-age'], 10);\n        if (isNaN(maxAge)) delete header['max-age'];\n        else header['max-age'] = maxAge;\n    }\n\n    return header;\n};\n","//      \n\nconst util = require('mapbox-gl/src/util/util');\nconst ajax = require('mapbox-gl/src/util/ajax');\nconst Evented = require('mapbox-gl/src/util/evented');\nconst loadArcGISMapServer = require('./load_arcgis_mapserver');\nconst TileBounds = require('mapbox-gl/src/source/tile_bounds');\nconst Texture = require('mapbox-gl/src/render/texture');\nconst helpers = require('./helpers');\n\n                                                        \n                                                                   \n                                            \n                                                            \n                                                  \n                                                           \n\nclass ArcGISTiledMapServiceSource extends Evented                   {\n\n                                  \n               \n                    \n                    \n                \n                   \n                     \n\n                                              \n                           \n                       \n                           \n             \n                         \n\n                     \n                                                                       \n\n    constructor(id        , options                                                          , dispatcher            , eventedParent         ) {\n        super();\n        this.id = id;\n        this.dispatcher = dispatcher;\n        this.setEventedParent(eventedParent);\n\n        this.type = 'arcgisraster';\n        this.minzoom = 0;\n        this.maxzoom = 22;\n        this.roundZoom = true;\n        this.tileSize = 512;\n        this._loaded = false;\n\n        this._options = util.extend({}, options);\n        util.extend(this, util.pick(options, ['url', 'scheme', 'tileSize']));\n    }\n\n    load() {\n        this.fire('dataloading', {dataType: 'source'});\n        loadArcGISMapServer(this._options, (err, metadata) => {\n            if (err) {\n                this.fire('error', err);\n            } else if (metadata) {\n                util.extend(this, metadata);\n\n                if (metadata.bounds) {\n                    this.tileBounds = new TileBounds(metadata.bounds, this.minzoom, this.maxzoom);\n                }\n\n            // `content` is included here to prevent a race condition where `Style#_updateSources` is called\n            // before the TileJSON arrives. this makes sure the tiles needed are loaded once TileJSON arrives\n            // ref: https://github.com/mapbox/mapbox-gl-js/pull/4347#discussion_r104418088\n            this.fire('data', {dataType: 'source', sourceDataType: 'metadata'});\n            this.fire('data', {dataType: 'source', sourceDataType: 'content'});\n            }\n        });\n    }\n\n    onAdd(map     ) {\n        // set the urls\n        const baseUrl = this.url.split('?')[0];\n        this.tileUrl = `${baseUrl}/tile/{z}/{y}/{x}`;\n\n        const arcgisonline = new RegExp(/tiles.arcgis(online)?\\.com/g);\n        if (arcgisonline.test(this.url)) {\n            this.tileUrl = this.tileUrl.replace('://tiles', '://tiles{s}');\n            this.subdomains = ['1', '2', '3', '4'];\n        }\n\n        if (this.token) {\n            this.tileUrl += (`?token=${this.token}`);\n        }\n        \n        this.map = map;\n        this.load();\n    }\n\n    serialize() {\n        return util.extend({}, this._options);\n    }\n\n    hasTile(tileID                  ) {\n        return !this.tileBounds || this.tileBounds.contains(tileID.canonical);\n    }\n\n    loadTile(tile      , callback                ) {\n        //convert to ags coords\n        const tilePoint = { z: tile.tileID.overscaledZ, x: tile.tileID.canonical.x, y: tile.tileID.canonical.y };\n\n        const url =  helpers._template(this.tileUrl, util.extend({\n            s: helpers._getSubdomain(tilePoint, this.subdomains),\n            z: (this._lodMap && this._lodMap[tilePoint.z]) ? this._lodMap[tilePoint.z] : tilePoint.z, // try lod map first, then just defualt to zoom level\n            x: tilePoint.x,\n            y: tilePoint.y\n        }, this.options));\n        tile.request = ajax.getImage({url},  (err, img) => {\n            delete tile.request;\n\n            if (tile.aborted) {\n                tile.state = 'unloaded';\n                callback(null);\n            } else if (err) {\n                tile.state = 'errored';\n                callback(err);\n            } else if (img) {\n                if (this.map._refreshExpiredTiles) tile.setExpiryData(img);\n                delete (img     ).cacheControl;\n                delete (img     ).expires;\n\n                const context = this.map.painter.context;\n                const gl = context.gl;\n                tile.texture = this.map.painter.getTileTexture(img.width);\n                if (tile.texture) {\n                    tile.texture.bind(gl.LINEAR, gl.CLAMP_TO_EDGE, gl.LINEAR_MIPMAP_NEAREST);\n                    gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, img);\n                } else {\n                    tile.texture = new Texture(context, img, gl.RGBA);\n                    tile.texture.bind(gl.LINEAR, gl.CLAMP_TO_EDGE, gl.LINEAR_MIPMAP_NEAREST);\n\n                    if (context.extTextureFilterAnisotropic) {\n                        gl.texParameterf(gl.TEXTURE_2D, context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, context.extTextureFilterAnisotropicMax);\n                    }\n                }\n                gl.generateMipmap(gl.TEXTURE_2D);\n\n                tile.state = 'loaded';\n\n                callback(null);\n            }\n        });\n    }\n\n    abortTile(tile      , callback                ) {\n        if (tile.request) {\n            tile.request.abort();\n            delete tile.request;\n        }\n        callback();\n    }\n\n    unloadTile(tile      , callback                ) {\n        if (tile.texture) this.map.painter.saveTileTexture(tile.texture);\n        callback();\n    }\n\n    hasTransition() {\n        return false;\n    }\n}\n\nmodule.exports = ArcGISTiledMapServiceSource;","\n//From https://github.com/Leaflet/Leaflet/blob/master/src/core/Util.js\nconst _templateRe = /\\{ *([\\w_]+) *\\}/g;\nconst _template = function (str, data) {\n    return str.replace(_templateRe, (str, key) => {\n        let value = data[key];\n\n        if (value === undefined) {\n            throw new Error(`No value provided for variable ${str}`);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n};\n\n//From https://github.com/Leaflet/Leaflet/blob/master/src/layer/tile/TileLayer.js\nconst _getSubdomain = function (tilePoint, subdomains) {\n    if (subdomains) {\n        const index = Math.abs(tilePoint.x + tilePoint.y) % subdomains.length;\n        return subdomains[index];\n    }\n    return null;\n};\n\nmodule.exports = {\n    _template,\n    _getSubdomain\n};\n","const ArcGISTiledMapServiceSource = require('./arcgis_tiled_map_service_source');\nmodule.exports = ArcGISTiledMapServiceSource;","'use strict';\nconst util = require('mapbox-gl/src/util/util');\nconst ajax = require('mapbox-gl/src/util/ajax');\nconst browser = require('mapbox-gl/src/util/browser');\nconst SphericalMercator = require('@mapbox/sphericalmercator');\n\n//Contains code from esri-leaflet https://github.com/Esri/esri-leaflet\nconst MercatorZoomLevels = {\n    '0': 156543.03392799999,\n    '1': 78271.516963999893,\n    '2': 39135.758482000099,\n    '3': 19567.879240999901,\n    '4': 9783.9396204999593,\n    '5': 4891.9698102499797,\n    '6': 2445.9849051249898,\n    '7': 1222.9924525624899,\n    '8': 611.49622628138002,\n    '9': 305.74811314055802,\n    '10': 152.874056570411,\n    '11': 76.437028285073197,\n    '12': 38.218514142536598,\n    '13': 19.109257071268299,\n    '14': 9.5546285356341496,\n    '15': 4.7773142679493699,\n    '16': 2.38865713397468,\n    '17': 1.1943285668550501,\n    '18': 0.59716428355981699,\n    '19': 0.29858214164761698,\n    '20': 0.14929107082381,\n    '21': 0.07464553541191,\n    '22': 0.0373227677059525,\n    '23': 0.0186613838529763\n};\n\nconst _withinPercentage = function (a, b, percentage) {\n    const diff = Math.abs((a / b) - 1);\n    return diff < percentage;\n};\n\nmodule.exports = function(options, callback) {\n    const loaded = function(err, metadata) {\n        if (err) {\n            return callback(err);\n        }\n\n        const result = util.pick(metadata,\n            ['tileInfo', 'initialExtent', 'fullExtent', 'spatialReference', 'tileServers', 'documentInfo']);\n\n        result._lodMap = {};\n        const zoomOffsetAllowance = 0.1;\n        const sr = metadata.spatialReference.latestWkid || metadata.spatialReference.wkid;\n        if (sr === 102100 || sr === 3857) {\n\n            /*\n            Example extent from ArcGIS REST API\n            fullExtent: {\n            xmin: -9144791.679226127,\n            ymin: -2195190.961437726,\n            xmax: -4650987.072019983,\n            ymax: 1118113.110155766,\n            spatialReference: {\n            wkid: 102100,\n            wkt: null\n            }\n            },\n            */\n            //convert ArcGIS extent to bounds\n            const extent = metadata.fullExtent;\n            if (extent && extent.spatialReference && extent.spatialReference.wkid ===  102100) {\n                const boundsWebMercator = [extent.xmin, extent.ymin, extent.xmax, extent.ymax];\n                var merc = new SphericalMercator({\n                    size: 256\n                });\n                const boundsWGS84 = merc.convert(boundsWebMercator);\n                result.bounds = boundsWGS84;\n            }\n\n            // create the zoom level data\n            const arcgisLODs = metadata.tileInfo.lods;\n            const correctResolutions = MercatorZoomLevels;\n            result.minzoom = arcgisLODs[0].level;\n            result.maxzoom = arcgisLODs[arcgisLODs.length - 1].level;\n            for (let i = 0; i < arcgisLODs.length; i++) {\n                const arcgisLOD = arcgisLODs[i];\n                for (const ci in correctResolutions) {\n                    const correctRes = correctResolutions[ci];\n\n                    if (_withinPercentage(arcgisLOD.resolution, correctRes, zoomOffsetAllowance)) {\n                        result._lodMap[ci] = arcgisLOD.level;\n                        break;\n                    }\n                }\n            }\n        } else {\n            callback(new Error('non-mercator spatial reference'));\n        }\n\n        callback(null, result);\n    };\n\n    if (options.url) {\n        ajax.getJSON({url: options.url}, loaded);\n    } else {\n        browser.frame(loaded.bind(null, null, options));\n    }\n};\n"]}