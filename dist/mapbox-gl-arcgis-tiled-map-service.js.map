{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/@mapbox/point-geometry/index.js","node_modules/@mapbox/sphericalmercator/sphericalmercator.js","node_modules/@mapbox/unitbezier/index.js","node_modules/mapbox-gl/src/geo/coordinate.js","node_modules/mapbox-gl/src/geo/lng_lat.js","node_modules/mapbox-gl/src/geo/lng_lat_bounds.js","node_modules/mapbox-gl/src/render/texture.js","node_modules/mapbox-gl/src/source/tile_bounds.js","node_modules/mapbox-gl/src/util/ajax.js","node_modules/mapbox-gl/src/util/browser.js","node_modules/mapbox-gl/src/util/browser/window.js","node_modules/mapbox-gl/src/util/evented.js","node_modules/mapbox-gl/src/util/util.js","src/arcgis_tiled_map_service_source.js","src/helpers.js","src/index.js","src/load_arcgis_mapserver.js"],"names":["Point","x","y","this","module","exports","prototype","clone","add","p","_add","sub","_sub","multByPoint","_multByPoint","divByPoint","_divByPoint","mult","k","_mult","div","_div","rotate","a","_rotate","rotateAround","_rotateAround","matMult","m","_matMult","unit","_unit","perp","_perp","round","_round","mag","Math","sqrt","equals","other","dist","distSqr","dx","dy","angle","atan2","angleTo","b","angleWith","angleWithSep","cos","sin","convert","Array","isArray","SphericalMercator","options","size","cache","c","Bc","Cc","zc","Ac","d","push","PI","D2R","R2D","A","MAXEXTENT","px","ll","zoom","f","min","max","log","g","atan","exp","bbox","tms_style","srs","pow","ur","concat","xyz","px_ll","px_ur","floor","bounds","minX","apply","minY","maxX","maxY","tms","to","forward","slice","inverse","xy","tan","UnitBezier","p1x","p1y","p2x","p2y","cx","bx","ax","cy","by","ay","sampleCurveX","t","sampleCurveY","sampleCurveDerivativeX","solveCurveX","epsilon","t0","t1","t2","x2","i","abs","d2","solve","Coordinate","column","row","zoomTo","_zoomTo","scale","const","wrap","require","LngLat","lng","lat","isNaN","Error","toArray","toString","toBounds","radius","latAccuracy","lngAccuracy","input","length","Number","LngLatBounds","sw","ne","setSouthWest","setNorthEast","_ne","_sw","extend","obj","sw2","ne2","every","getCenter","getSouthWest","getNorthEast","getNorthWest","getWest","getNorth","getSouthEast","getEast","getSouth","ref","HTMLImageElement","HTMLCanvasElement","HTMLVideoElement","ImageData","Texture","context","image","format","premultiply","width","height","texture","gl","createTexture","update","bindTexture","TEXTURE_2D","pixelStoreUnpack","set","RGBA","pixelStoreUnpackPremultiplyAlpha","texImage2D","UNSIGNED_BYTE","data","bind","filter","minFilter","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","destroy","deleteTexture","clamp","TileBounds","minzoom","maxzoom","validateBounds","contains","tileID","level","lngX","z","latY","ceil","makeRequest","requestParameters","xhr","window","XMLHttpRequest","open","url","headers","setRequestHeader","withCredentials","credentials","sameOrigin","document","createElement","href","protocol","location","host","ResourceType","Unknown","Style","Source","Tile","Glyphs","SpriteImage","SpriteJSON","Image","Object","freeze","AJAXError","message","status","super","call","create","constructor","getJSON","callback","onerror","statusText","onload","response","let","JSON","parse","err","send","getArrayBuffer","responseType","byteLength","cacheControl","getResponseHeader","expires","transparentPngUrl","getImage","imgData","img","URL","webkitURL","revokeObjectURL","src","blob","Blob","Uint8Array","type","createObjectURL","getVideo","urls","video","onloadstart","s","crossOrigin","appendChild","now","performance","Date","frame","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancel","cancelAnimationFrame","mozCancelAnimationFrame","webkitCancelAnimationFrame","msCancelAnimationFrame","fn","cancelFrame","id","getImageData","canvas","getContext","drawImage","hardwareConcurrency","navigator","devicePixelRatio","supportsWebp","webpImgTest","self","_addEventListener","listener","listenerList","_removeEventListener","index","indexOf","splice","util","Evented","on","_listeners","off","_oneTimeListeners","once","fire","this$1","listens","target","listeners","list","oneTimeListeners","i$1","list$1","listener$1","_eventedParent","_eventedParentData","endsWith","console","error","setEventedParent","parent","easeCubicInOut","t3","bezier","ease","n","w","asyncAll","array","remaining","results","forEach","item","result","values","keysDifference","difference","dest","sources","len","arguments","pick","properties","uniqueId","bindAll","fns","getCoordinatesCenter","coords","Infinity","dMax","LN2","string","suffix","mapObject","iterator","output","key","filterObject","deepEqual","keys","map","arraysIntersect","l","warnOnceHistory","warnOnce","warn","isCounterClockwise","calculateSignedArea","ring","sum","j","p1","p2","isClosedPolygon","points","sphericalToCartesian","r","azimuthal","polar","parseCacheControl","header","replace","$0","$1","$2","$3","value","toLowerCase","maxAge","parseInt","ajax","loadArcGISMapServer","helpers","ArcGISTiledMapServiceSource","dispatcher","eventedParent","roundZoom","tileSize","_loaded","_options","load","dataType","metadata","tileBounds","sourceDataType","onAdd","baseUrl","split","tileUrl","RegExp","test","subdomains","token","serialize","hasTile","canonical","loadTile","tile","tilePoint","overscaledZ","_template","_getSubdomain","_lodMap","request","aborted","state","_refreshExpiredTiles","setExpiryData","painter","getTileTexture","LINEAR","CLAMP_TO_EDGE","LINEAR_MIPMAP_NEAREST","texSubImage2D","extTextureFilterAnisotropic","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","extTextureFilterAnisotropicMax","generateMipmap","abortTile","abort","unloadTile","saveTileTexture","hasTransition","_templateRe","str","undefined","browser","MercatorZoomLevels","0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","_withinPercentage","percentage","loaded","sr","spatialReference","latestWkid","wkid","extent","fullExtent","boundsWebMercator","xmin","ymin","xmax","ymax","merc","boundsWGS84","arcgisLODs","tileInfo","lods","correctResolutions","arcgisLOD","ci","correctRes","resolution"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict';\n\nmodule.exports = Point;\n\n/**\n * A standalone point geometry with useful accessor, comparison, and\n * modification methods.\n *\n * @class Point\n * @param {Number} x the x-coordinate. this could be longitude or screen\n * pixels, or any other sort of unit.\n * @param {Number} y the y-coordinate. this could be latitude or screen\n * pixels, or any other sort of unit.\n * @example\n * var point = new Point(-77, 38);\n */\nfunction Point(x, y) {\n    this.x = x;\n    this.y = y;\n}\n\nPoint.prototype = {\n\n    /**\n     * Clone this point, returning a new point that can be modified\n     * without affecting the old one.\n     * @return {Point} the clone\n     */\n    clone: function() { return new Point(this.x, this.y); },\n\n    /**\n     * Add this point's x & y coordinates to another point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    add:     function(p) { return this.clone()._add(p); },\n\n    /**\n     * Subtract this point's x & y coordinates to from point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    sub:     function(p) { return this.clone()._sub(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    multByPoint:    function(p) { return this.clone()._multByPoint(p); },\n\n    /**\n     * Divide this point's x & y coordinates by point,\n     * yielding a new point.\n     * @param {Point} p the other point\n     * @return {Point} output point\n     */\n    divByPoint:     function(p) { return this.clone()._divByPoint(p); },\n\n    /**\n     * Multiply this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {Point} k factor\n     * @return {Point} output point\n     */\n    mult:    function(k) { return this.clone()._mult(k); },\n\n    /**\n     * Divide this point's x & y coordinates by a factor,\n     * yielding a new point.\n     * @param {Point} k factor\n     * @return {Point} output point\n     */\n    div:     function(k) { return this.clone()._div(k); },\n\n    /**\n     * Rotate this point around the 0, 0 origin by an angle a,\n     * given in radians\n     * @param {Number} a angle to rotate around, in radians\n     * @return {Point} output point\n     */\n    rotate:  function(a) { return this.clone()._rotate(a); },\n\n    /**\n     * Rotate this point around p point by an angle a,\n     * given in radians\n     * @param {Number} a angle to rotate around, in radians\n     * @param {Point} p Point to rotate around\n     * @return {Point} output point\n     */\n    rotateAround:  function(a,p) { return this.clone()._rotateAround(a,p); },\n\n    /**\n     * Multiply this point by a 4x1 transformation matrix\n     * @param {Array<Number>} m transformation matrix\n     * @return {Point} output point\n     */\n    matMult: function(m) { return this.clone()._matMult(m); },\n\n    /**\n     * Calculate this point but as a unit vector from 0, 0, meaning\n     * that the distance from the resulting point to the 0, 0\n     * coordinate will be equal to 1 and the angle from the resulting\n     * point to the 0, 0 coordinate will be the same as before.\n     * @return {Point} unit vector point\n     */\n    unit:    function() { return this.clone()._unit(); },\n\n    /**\n     * Compute a perpendicular point, where the new y coordinate\n     * is the old x coordinate and the new x coordinate is the old y\n     * coordinate multiplied by -1\n     * @return {Point} perpendicular point\n     */\n    perp:    function() { return this.clone()._perp(); },\n\n    /**\n     * Return a version of this point with the x & y coordinates\n     * rounded to integers.\n     * @return {Point} rounded point\n     */\n    round:   function() { return this.clone()._round(); },\n\n    /**\n     * Return the magitude of this point: this is the Euclidean\n     * distance from the 0, 0 coordinate to this point's x and y\n     * coordinates.\n     * @return {Number} magnitude\n     */\n    mag: function() {\n        return Math.sqrt(this.x * this.x + this.y * this.y);\n    },\n\n    /**\n     * Judge whether this point is equal to another point, returning\n     * true or false.\n     * @param {Point} other the other point\n     * @return {boolean} whether the points are equal\n     */\n    equals: function(other) {\n        return this.x === other.x &&\n               this.y === other.y;\n    },\n\n    /**\n     * Calculate the distance from this point to another point\n     * @param {Point} p the other point\n     * @return {Number} distance\n     */\n    dist: function(p) {\n        return Math.sqrt(this.distSqr(p));\n    },\n\n    /**\n     * Calculate the distance from this point to another point,\n     * without the square root step. Useful if you're comparing\n     * relative distances.\n     * @param {Point} p the other point\n     * @return {Number} distance\n     */\n    distSqr: function(p) {\n        var dx = p.x - this.x,\n            dy = p.y - this.y;\n        return dx * dx + dy * dy;\n    },\n\n    /**\n     * Get the angle from the 0, 0 coordinate to this point, in radians\n     * coordinates.\n     * @return {Number} angle\n     */\n    angle: function() {\n        return Math.atan2(this.y, this.x);\n    },\n\n    /**\n     * Get the angle from this point to another point, in radians\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleTo: function(b) {\n        return Math.atan2(this.y - b.y, this.x - b.x);\n    },\n\n    /**\n     * Get the angle between this point and another point, in radians\n     * @param {Point} b the other point\n     * @return {Number} angle\n     */\n    angleWith: function(b) {\n        return this.angleWithSep(b.x, b.y);\n    },\n\n    /*\n     * Find the angle of the two vectors, solving the formula for\n     * the cross product a x b = |a||b|sin(θ) for θ.\n     * @param {Number} x the x-coordinate\n     * @param {Number} y the y-coordinate\n     * @return {Number} the angle in radians\n     */\n    angleWithSep: function(x, y) {\n        return Math.atan2(\n            this.x * y - this.y * x,\n            this.x * x + this.y * y);\n    },\n\n    _matMult: function(m) {\n        var x = m[0] * this.x + m[1] * this.y,\n            y = m[2] * this.x + m[3] * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _add: function(p) {\n        this.x += p.x;\n        this.y += p.y;\n        return this;\n    },\n\n    _sub: function(p) {\n        this.x -= p.x;\n        this.y -= p.y;\n        return this;\n    },\n\n    _mult: function(k) {\n        this.x *= k;\n        this.y *= k;\n        return this;\n    },\n\n    _div: function(k) {\n        this.x /= k;\n        this.y /= k;\n        return this;\n    },\n\n    _multByPoint: function(p) {\n        this.x *= p.x;\n        this.y *= p.y;\n        return this;\n    },\n\n    _divByPoint: function(p) {\n        this.x /= p.x;\n        this.y /= p.y;\n        return this;\n    },\n\n    _unit: function() {\n        this._div(this.mag());\n        return this;\n    },\n\n    _perp: function() {\n        var y = this.y;\n        this.y = this.x;\n        this.x = -y;\n        return this;\n    },\n\n    _rotate: function(angle) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = cos * this.x - sin * this.y,\n            y = sin * this.x + cos * this.y;\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _rotateAround: function(angle, p) {\n        var cos = Math.cos(angle),\n            sin = Math.sin(angle),\n            x = p.x + cos * (this.x - p.x) - sin * (this.y - p.y),\n            y = p.y + sin * (this.x - p.x) + cos * (this.y - p.y);\n        this.x = x;\n        this.y = y;\n        return this;\n    },\n\n    _round: function() {\n        this.x = Math.round(this.x);\n        this.y = Math.round(this.y);\n        return this;\n    }\n};\n\n/**\n * Construct a point from an array if necessary, otherwise if the input\n * is already a Point, or an unknown type, return it unchanged\n * @param {Array<Number>|Point|*} a any kind of input value\n * @return {Point} constructed point, or passed-through value.\n * @example\n * // this\n * var point = Point.convert([0, 1]);\n * // is equivalent to\n * var point = new Point(0, 1);\n */\nPoint.convert = function (a) {\n    if (a instanceof Point) {\n        return a;\n    }\n    if (Array.isArray(a)) {\n        return new Point(a[0], a[1]);\n    }\n    return a;\n};\n","var SphericalMercator = (function(){\n\n// Closures including constants and other precalculated values.\nvar cache = {},\n    EPSLN = 1.0e-10,\n    D2R = Math.PI / 180,\n    R2D = 180 / Math.PI,\n    // 900913 properties.\n    A = 6378137.0,\n    MAXEXTENT = 20037508.342789244;\n\n\n// SphericalMercator constructor: precaches calculations\n// for fast tile lookups.\nfunction SphericalMercator(options) {\n    options = options || {};\n    this.size = options.size || 256;\n    if (!cache[this.size]) {\n        var size = this.size;\n        var c = cache[this.size] = {};\n        c.Bc = [];\n        c.Cc = [];\n        c.zc = [];\n        c.Ac = [];\n        for (var d = 0; d < 30; d++) {\n            c.Bc.push(size / 360);\n            c.Cc.push(size / (2 * Math.PI));\n            c.zc.push(size / 2);\n            c.Ac.push(size);\n            size *= 2;\n        }\n    }\n    this.Bc = cache[this.size].Bc;\n    this.Cc = cache[this.size].Cc;\n    this.zc = cache[this.size].zc;\n    this.Ac = cache[this.size].Ac;\n};\n\n// Convert lon lat to screen pixel value\n//\n// - `ll` {Array} `[lon, lat]` array of geographic coordinates.\n// - `zoom` {Number} zoom level.\nSphericalMercator.prototype.px = function(ll, zoom) {\n    var d = this.zc[zoom];\n    var f = Math.min(Math.max(Math.sin(D2R * ll[1]), -0.9999), 0.9999);\n    var x = Math.round(d + ll[0] * this.Bc[zoom]);\n    var y = Math.round(d + 0.5 * Math.log((1 + f) / (1 - f)) * (-this.Cc[zoom]));\n    (x > this.Ac[zoom]) && (x = this.Ac[zoom]);\n    (y > this.Ac[zoom]) && (y = this.Ac[zoom]);\n    //(x < 0) && (x = 0);\n    //(y < 0) && (y = 0);\n    return [x, y];\n};\n\n// Convert screen pixel value to lon lat\n//\n// - `px` {Array} `[x, y]` array of geographic coordinates.\n// - `zoom` {Number} zoom level.\nSphericalMercator.prototype.ll = function(px, zoom) {\n    var g = (px[1] - this.zc[zoom]) / (-this.Cc[zoom]);\n    var lon = (px[0] - this.zc[zoom]) / this.Bc[zoom];\n    var lat = R2D * (2 * Math.atan(Math.exp(g)) - 0.5 * Math.PI);\n    return [lon, lat];\n};\n\n// Convert tile xyz value to bbox of the form `[w, s, e, n]`\n//\n// - `x` {Number} x (longitude) number.\n// - `y` {Number} y (latitude) number.\n// - `zoom` {Number} zoom.\n// - `tms_style` {Boolean} whether to compute using tms-style.\n// - `srs` {String} projection for resulting bbox (WGS84|900913).\n// - `return` {Array} bbox array of values in form `[w, s, e, n]`.\nSphericalMercator.prototype.bbox = function(x, y, zoom, tms_style, srs) {\n    // Convert xyz into bbox with srs WGS84\n    if (tms_style) {\n        y = (Math.pow(2, zoom) - 1) - y;\n    }\n    // Use +y to make sure it's a number to avoid inadvertent concatenation.\n    var ll = [x * this.size, (+y + 1) * this.size]; // lower left\n    // Use +x to make sure it's a number to avoid inadvertent concatenation.\n    var ur = [(+x + 1) * this.size, y * this.size]; // upper right\n    var bbox = this.ll(ll, zoom).concat(this.ll(ur, zoom));\n\n    // If web mercator requested reproject to 900913.\n    if (srs === '900913') {\n        return this.convert(bbox, '900913');\n    } else {\n        return bbox;\n    }\n};\n\n// Convert bbox to xyx bounds\n//\n// - `bbox` {Number} bbox in the form `[w, s, e, n]`.\n// - `zoom` {Number} zoom.\n// - `tms_style` {Boolean} whether to compute using tms-style.\n// - `srs` {String} projection of input bbox (WGS84|900913).\n// - `@return` {Object} XYZ bounds containing minX, maxX, minY, maxY properties.\nSphericalMercator.prototype.xyz = function(bbox, zoom, tms_style, srs) {\n    // If web mercator provided reproject to WGS84.\n    if (srs === '900913') {\n        bbox = this.convert(bbox, 'WGS84');\n    }\n\n    var ll = [bbox[0], bbox[1]]; // lower left\n    var ur = [bbox[2], bbox[3]]; // upper right\n    var px_ll = this.px(ll, zoom);\n    var px_ur = this.px(ur, zoom);\n    // Y = 0 for XYZ is the top hence minY uses px_ur[1].\n    var x = [ Math.floor(px_ll[0] / this.size), Math.floor((px_ur[0] - 1) / this.size) ];\n    var y = [ Math.floor(px_ur[1] / this.size), Math.floor((px_ll[1] - 1) / this.size) ];\n    var bounds = {\n        minX: Math.min.apply(Math, x) < 0 ? 0 : Math.min.apply(Math, x),\n        minY: Math.min.apply(Math, y) < 0 ? 0 : Math.min.apply(Math, y),\n        maxX: Math.max.apply(Math, x),\n        maxY: Math.max.apply(Math, y)\n    };\n    if (tms_style) {\n        var tms = {\n            minY: (Math.pow(2, zoom) - 1) - bounds.maxY,\n            maxY: (Math.pow(2, zoom) - 1) - bounds.minY\n        };\n        bounds.minY = tms.minY;\n        bounds.maxY = tms.maxY;\n    }\n    return bounds;\n};\n\n// Convert projection of given bbox.\n//\n// - `bbox` {Number} bbox in the form `[w, s, e, n]`.\n// - `to` {String} projection of output bbox (WGS84|900913). Input bbox\n//   assumed to be the \"other\" projection.\n// - `@return` {Object} bbox with reprojected coordinates.\nSphericalMercator.prototype.convert = function(bbox, to) {\n    if (to === '900913') {\n        return this.forward(bbox.slice(0, 2)).concat(this.forward(bbox.slice(2,4)));\n    } else {\n        return this.inverse(bbox.slice(0, 2)).concat(this.inverse(bbox.slice(2,4)));\n    }\n};\n\n// Convert lon/lat values to 900913 x/y.\nSphericalMercator.prototype.forward = function(ll) {\n    var xy = [\n        A * ll[0] * D2R,\n        A * Math.log(Math.tan((Math.PI*0.25) + (0.5 * ll[1] * D2R)))\n    ];\n    // if xy value is beyond maxextent (e.g. poles), return maxextent.\n    (xy[0] > MAXEXTENT) && (xy[0] = MAXEXTENT);\n    (xy[0] < -MAXEXTENT) && (xy[0] = -MAXEXTENT);\n    (xy[1] > MAXEXTENT) && (xy[1] = MAXEXTENT);\n    (xy[1] < -MAXEXTENT) && (xy[1] = -MAXEXTENT);\n    return xy;\n};\n\n// Convert 900913 x/y values to lon/lat.\nSphericalMercator.prototype.inverse = function(xy) {\n    return [\n        (xy[0] * R2D / A),\n        ((Math.PI*0.5) - 2.0 * Math.atan(Math.exp(-xy[1] / A))) * R2D\n    ];\n};\n\nreturn SphericalMercator;\n\n})();\n\nif (typeof module !== 'undefined' && typeof exports !== 'undefined') {\n    module.exports = exports = SphericalMercator;\n}\n","/*\n * Copyright (C) 2008 Apple Inc. All Rights Reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY\n * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR\n * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n *\n * Ported from Webkit\n * http://svn.webkit.org/repository/webkit/trunk/Source/WebCore/platform/graphics/UnitBezier.h\n */\n\nmodule.exports = UnitBezier;\n\nfunction UnitBezier(p1x, p1y, p2x, p2y) {\n    // Calculate the polynomial coefficients, implicit first and last control points are (0,0) and (1,1).\n    this.cx = 3.0 * p1x;\n    this.bx = 3.0 * (p2x - p1x) - this.cx;\n    this.ax = 1.0 - this.cx - this.bx;\n\n    this.cy = 3.0 * p1y;\n    this.by = 3.0 * (p2y - p1y) - this.cy;\n    this.ay = 1.0 - this.cy - this.by;\n\n    this.p1x = p1x;\n    this.p1y = p2y;\n    this.p2x = p2x;\n    this.p2y = p2y;\n}\n\nUnitBezier.prototype.sampleCurveX = function(t) {\n    // `ax t^3 + bx t^2 + cx t' expanded using Horner's rule.\n    return ((this.ax * t + this.bx) * t + this.cx) * t;\n};\n\nUnitBezier.prototype.sampleCurveY = function(t) {\n    return ((this.ay * t + this.by) * t + this.cy) * t;\n};\n\nUnitBezier.prototype.sampleCurveDerivativeX = function(t) {\n    return (3.0 * this.ax * t + 2.0 * this.bx) * t + this.cx;\n};\n\nUnitBezier.prototype.solveCurveX = function(x, epsilon) {\n    if (typeof epsilon === 'undefined') epsilon = 1e-6;\n\n    var t0, t1, t2, x2, i;\n\n    // First try a few iterations of Newton's method -- normally very fast.\n    for (t2 = x, i = 0; i < 8; i++) {\n\n        x2 = this.sampleCurveX(t2) - x;\n        if (Math.abs(x2) < epsilon) return t2;\n\n        var d2 = this.sampleCurveDerivativeX(t2);\n        if (Math.abs(d2) < 1e-6) break;\n\n        t2 = t2 - x2 / d2;\n    }\n\n    // Fall back to the bisection method for reliability.\n    t0 = 0.0;\n    t1 = 1.0;\n    t2 = x;\n\n    if (t2 < t0) return t0;\n    if (t2 > t1) return t1;\n\n    while (t0 < t1) {\n\n        x2 = this.sampleCurveX(t2);\n        if (Math.abs(x2 - x) < epsilon) return t2;\n\n        if (x > x2) {\n            t0 = t2;\n        } else {\n            t1 = t2;\n        }\n\n        t2 = (t1 - t0) * 0.5 + t0;\n    }\n\n    // Failure.\n    return t2;\n};\n\nUnitBezier.prototype.solve = function(x, epsilon) {\n    return this.sampleCurveY(this.solveCurveX(x, epsilon));\n};\n","//      \n\n/**\n * A coordinate is a column, row, zoom combination, often used\n * as the data component of a tile.\n *\n * @param {number} column\n * @param {number} row\n * @param {number} zoom\n * @private\n */\nclass Coordinate {\n                   \n                \n                 \n    constructor(column        , row        , zoom        ) {\n        this.column = column;\n        this.row = row;\n        this.zoom = zoom;\n    }\n\n    /**\n     * Create a clone of this coordinate that can be mutated without\n     * changing the original coordinate\n     *\n     * @returns {Coordinate} clone\n     * @private\n     * var coord = new Coordinate(0, 0, 0);\n     * var c2 = coord.clone();\n     * // since coord is cloned, modifying a property of c2 does\n     * // not modify it.\n     * c2.zoom = 2;\n     */\n    clone() {\n        return new Coordinate(this.column, this.row, this.zoom);\n    }\n\n    /**\n     * Zoom this coordinate to a given zoom level. This returns a new\n     * coordinate object, not mutating the old one.\n     *\n     * @param {number} zoom\n     * @returns {Coordinate} zoomed coordinate\n     * @private\n     * @example\n     * var coord = new Coordinate(0, 0, 0);\n     * var c2 = coord.zoomTo(1);\n     * c2 // equals new Coordinate(0, 0, 1);\n     */\n    zoomTo(zoom        ) { return this.clone()._zoomTo(zoom); }\n\n    /**\n     * Subtract the column and row values of this coordinate from those\n     * of another coordinate. The other coordinat will be zoomed to the\n     * same level as `this` before the subtraction occurs\n     *\n     * @param {Coordinate} c other coordinate\n     * @returns {Coordinate} result\n     * @private\n     */\n    sub(c            ) { return this.clone()._sub(c); }\n\n    _zoomTo(zoom        ) {\n        const scale = Math.pow(2, zoom - this.zoom);\n        this.column *= scale;\n        this.row *= scale;\n        this.zoom = zoom;\n        return this;\n    }\n\n    _sub(c            ) {\n        c = c.zoomTo(this.zoom);\n        this.column -= c.column;\n        this.row -= c.row;\n        return this;\n    }\n}\n\nmodule.exports = Coordinate;\n","//      \n\nconst wrap = require('../util/util').wrap;\n\n/**\n * A `LngLat` object represents a given longitude and latitude coordinate, measured in degrees.\n *\n * Mapbox GL uses longitude, latitude coordinate order (as opposed to latitude, longitude) to match GeoJSON.\n *\n * Note that any Mapbox GL method that accepts a `LngLat` object as an argument or option\n * can also accept an `Array` of two numbers and will perform an implicit conversion.\n * This flexible type is documented as {@link LngLatLike}.\n *\n * @param {number} lng Longitude, measured in degrees.\n * @param {number} lat Latitude, measured in degrees.\n * @example\n * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n * @see [Get coordinates of the mouse pointer](https://www.mapbox.com/mapbox-gl-js/example/mouse-position/)\n * @see [Display a popup](https://www.mapbox.com/mapbox-gl-js/example/popup/)\n * @see [Highlight features within a bounding box](https://www.mapbox.com/mapbox-gl-js/example/using-box-queryrenderedfeatures/)\n * @see [Create a timeline animation](https://www.mapbox.com/mapbox-gl-js/example/timeline-animation/)\n */\nclass LngLat {\n                \n                \n\n    constructor(lng        , lat        ) {\n        if (isNaN(lng) || isNaN(lat)) {\n            throw new Error(`Invalid LngLat object: (${lng}, ${lat})`);\n        }\n        this.lng = +lng;\n        this.lat = +lat;\n        if (this.lat > 90 || this.lat < -90) {\n            throw new Error('Invalid LngLat latitude value: must be between -90 and 90');\n        }\n    }\n\n    /**\n     * Returns a new `LngLat` object whose longitude is wrapped to the range (-180, 180).\n     *\n     * @returns {LngLat} The wrapped `LngLat` object.\n     * @example\n     * var ll = new mapboxgl.LngLat(286.0251, 40.7736);\n     * var wrapped = ll.wrap();\n     * wrapped.lng; // = -73.9749\n     */\n    wrap() {\n        return new LngLat(wrap(this.lng, -180, 180), this.lat);\n    }\n\n    /**\n     * Returns the coordinates represented as an array of two numbers.\n     *\n     * @returns {Array<number>} The coordinates represeted as an array of longitude and latitude.\n     * @example\n     * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n     * ll.toArray(); // = [-73.9749, 40.7736]\n     */\n    toArray() {\n        return [this.lng, this.lat];\n    }\n\n    /**\n     * Returns the coordinates represent as a string.\n     *\n     * @returns {string} The coordinates represented as a string of the format `'LngLat(lng, lat)'`.\n     * @example\n     * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n     * ll.toString(); // = \"LngLat(-73.9749, 40.7736)\"\n     */\n    toString() {\n        return `LngLat(${this.lng}, ${this.lat})`;\n    }\n\n    /**\n     * Returns a `LngLatBounds` from the coordinates extended by a given `radius`.\n     *\n     * @param {number} radius Distance in meters from the coordinates to extend the bounds.\n     * @returns {LngLatBounds} A new `LngLatBounds` object representing the coordinates extended by the `radius`.\n     * @example\n     * var ll = new mapboxgl.LngLat(-73.9749, 40.7736);\n     * ll.toBounds(100).toArray(); // = [[-73.97501862141328, 40.77351016847229], [-73.97478137858673, 40.77368983152771]]\n     */\n    toBounds(radius        ) {\n        const earthCircumferenceInMetersAtEquator = 40075017;\n        const latAccuracy = 360 * radius / earthCircumferenceInMetersAtEquator,\n            lngAccuracy = latAccuracy / Math.cos((Math.PI / 180) * this.lat);\n\n        const LngLatBounds = require('./lng_lat_bounds');\n        return new LngLatBounds(new LngLat(this.lng - lngAccuracy, this.lat - latAccuracy),\n            new LngLat(this.lng + lngAccuracy, this.lat + latAccuracy));\n    }\n\n    /**\n     * Converts an array of two numbers to a `LngLat` object.\n     *\n     * If a `LngLat` object is passed in, the function returns it unchanged.\n     *\n     * @param {LngLatLike} input An array of two numbers to convert, or a `LngLat` object to return.\n     * @returns {LngLat} A new `LngLat` object, if a conversion occurred, or the original `LngLat` object.\n     * @example\n     * var arr = [-73.9749, 40.7736];\n     * var ll = mapboxgl.LngLat.convert(arr);\n     * ll;   // = LngLat {lng: -73.9749, lat: 40.7736}\n     */\n    static convert(input            )         {\n        if (input instanceof LngLat) {\n            return input;\n        }\n        if (Array.isArray(input) && (input.length === 2 || input.length === 3)) {\n            return new LngLat(Number(input[0]), Number(input[1]));\n        }\n        if (!Array.isArray(input) && typeof input === 'object' && input !== null) {\n            return new LngLat(Number(input.lng), Number(input.lat));\n        }\n        throw new Error(\"`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]\");\n    }\n}\n\n/**\n * A {@link LngLat} object, an array of two numbers representing longitude and latitude,\n * or an object with `lng` and `lat` properties.\n *\n * @typedef {LngLat | {lng: number, lat: number} | [number, number]} LngLatLike\n * @example\n * var v1 = new mapboxgl.LngLat(-122.420679, 37.772537);\n * var v2 = [-122.420679, 37.772537];\n */\n                                                                                \n\nmodule.exports = LngLat;\n","//      \n\nconst LngLat = require('./lng_lat');\n\n                                          \n\n/**\n * A `LngLatBounds` object represents a geographical bounding box,\n * defined by its southwest and northeast points in longitude and latitude.\n *\n * If no arguments are provided to the constructor, a `null` bounding box is created.\n *\n * Note that any Mapbox GL method that accepts a `LngLatBounds` object as an argument or option\n * can also accept an `Array` of two {@link LngLatLike} constructs and will perform an implicit conversion.\n * This flexible type is documented as {@link LngLatBoundsLike}.\n *\n * @param {LngLatLike} [sw] The southwest corner of the bounding box.\n * @param {LngLatLike} [ne] The northeast corner of the bounding box.\n * @example\n * var sw = new mapboxgl.LngLat(-73.9876, 40.7661);\n * var ne = new mapboxgl.LngLat(-73.9397, 40.8002);\n * var llb = new mapboxgl.LngLatBounds(sw, ne);\n */\nclass LngLatBounds {\n                \n                \n\n    // This constructor is too flexible to type. It should not be so flexible.\n    constructor(sw     , ne     ) {\n        if (!sw) {\n            return;\n        } else if (ne) {\n            this.setSouthWest(sw).setNorthEast(ne);\n        } else if (sw.length === 4) {\n            this.setSouthWest([sw[0], sw[1]]).setNorthEast([sw[2], sw[3]]);\n        } else {\n            this.setSouthWest(sw[0]).setNorthEast(sw[1]);\n        }\n    }\n\n    /**\n     * Set the northeast corner of the bounding box\n     *\n     * @param {LngLatLike} ne\n     * @returns {LngLatBounds} `this`\n     */\n    setNorthEast(ne            ) {\n        this._ne = ne instanceof LngLat ? new LngLat(ne.lng, ne.lat) : LngLat.convert(ne);\n        return this;\n    }\n\n    /**\n     * Set the southwest corner of the bounding box\n     *\n     * @param {LngLatLike} sw\n     * @returns {LngLatBounds} `this`\n     */\n    setSouthWest(sw            ) {\n        this._sw = sw instanceof LngLat ? new LngLat(sw.lng, sw.lat) : LngLat.convert(sw);\n        return this;\n    }\n\n    /**\n     * Extend the bounds to include a given LngLat or LngLatBounds.\n     *\n     * @param {LngLat|LngLatBounds} obj object to extend to\n     * @returns {LngLatBounds} `this`\n     */\n    extend(obj) {\n        const sw = this._sw,\n            ne = this._ne;\n        let sw2, ne2;\n\n        if (obj instanceof LngLat) {\n            sw2 = obj;\n            ne2 = obj;\n\n        } else if (obj instanceof LngLatBounds) {\n            sw2 = obj._sw;\n            ne2 = obj._ne;\n\n            if (!sw2 || !ne2) return this;\n\n        } else {\n            if (Array.isArray(obj)) {\n                if (obj.every(Array.isArray)) {\n                    return this.extend(LngLatBounds.convert(obj));\n                } else {\n                    return this.extend(LngLat.convert(obj));\n                }\n            }\n            return this;\n        }\n\n        if (!sw && !ne) {\n            this._sw = new LngLat(sw2.lng, sw2.lat);\n            this._ne = new LngLat(ne2.lng, ne2.lat);\n\n        } else {\n            sw.lng = Math.min(sw2.lng, sw.lng);\n            sw.lat = Math.min(sw2.lat, sw.lat);\n            ne.lng = Math.max(ne2.lng, ne.lng);\n            ne.lat = Math.max(ne2.lat, ne.lat);\n        }\n\n        return this;\n    }\n\n    /**\n     * Returns the geographical coordinate equidistant from the bounding box's corners.\n     *\n     * @returns {LngLat} The bounding box's center.\n     * @example\n     * var llb = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002]);\n     * llb.getCenter(); // = LngLat {lng: -73.96365, lat: 40.78315}\n     */\n    getCenter()         {\n        return new LngLat((this._sw.lng + this._ne.lng) / 2, (this._sw.lat + this._ne.lat) / 2);\n    }\n\n    /**\n     * Returns the southwest corner of the bounding box.\n     *\n     * @returns {LngLat} The southwest corner of the bounding box.\n     */\n    getSouthWest()         { return this._sw; }\n\n    /**\n    * Returns the northeast corner of the bounding box.\n    *\n    * @returns {LngLat} The northeast corner of the bounding box.\n     */\n    getNorthEast()         { return this._ne; }\n\n    /**\n    * Returns the northwest corner of the bounding box.\n    *\n    * @returns {LngLat} The northwest corner of the bounding box.\n     */\n    getNorthWest()         { return new LngLat(this.getWest(), this.getNorth()); }\n\n    /**\n    * Returns the southeast corner of the bounding box.\n    *\n    * @returns {LngLat} The southeast corner of the bounding box.\n     */\n    getSouthEast()         { return new LngLat(this.getEast(), this.getSouth()); }\n\n    /**\n    * Returns the west edge of the bounding box.\n    *\n    * @returns {number} The west edge of the bounding box.\n     */\n    getWest()         { return this._sw.lng; }\n\n    /**\n    * Returns the south edge of the bounding box.\n    *\n    * @returns {number} The south edge of the bounding box.\n     */\n    getSouth()         { return this._sw.lat; }\n\n    /**\n    * Returns the east edge of the bounding box.\n    *\n    * @returns {number} The east edge of the bounding box.\n     */\n    getEast()         { return this._ne.lng; }\n\n    /**\n    * Returns the north edge of the bounding box.\n    *\n    * @returns {number} The north edge of the bounding box.\n     */\n    getNorth()         { return this._ne.lat; }\n\n    /**\n     * Returns the bounding box represented as an array.\n     *\n     * @returns {Array<Array<number>>} The bounding box represented as an array, consisting of the\n     *   southwest and northeast coordinates of the bounding represented as arrays of numbers.\n     * @example\n     * var llb = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002]);\n     * llb.toArray(); // = [[-73.9876, 40.7661], [-73.9397, 40.8002]]\n     */\n    toArray() {\n        return [this._sw.toArray(), this._ne.toArray()];\n    }\n\n    /**\n     * Return the bounding box represented as a string.\n     *\n     * @returns {string} The bounding box represents as a string of the format\n     *   `'LngLatBounds(LngLat(lng, lat), LngLat(lng, lat))'`.\n     * @example\n     * var llb = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002]);\n     * llb.toString(); // = \"LngLatBounds(LngLat(-73.9876, 40.7661), LngLat(-73.9397, 40.8002))\"\n     */\n    toString() {\n        return `LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`;\n    }\n\n    /**\n     * Converts an array to a `LngLatBounds` object.\n     *\n     * If a `LngLatBounds` object is passed in, the function returns it unchanged.\n     *\n     * Internally, the function calls `LngLat#convert` to convert arrays to `LngLat` values.\n     *\n     * @param {LngLatBoundsLike} input An array of two coordinates to convert, or a `LngLatBounds` object to return.\n     * @returns {LngLatBounds} A new `LngLatBounds` object, if a conversion occurred, or the original `LngLatBounds` object.\n     * @example\n     * var arr = [[-73.9876, 40.7661], [-73.9397, 40.8002]];\n     * var llb = mapboxgl.LngLatBounds.convert(arr);\n     * llb;   // = LngLatBounds {_sw: LngLat {lng: -73.9876, lat: 40.7661}, _ne: LngLat {lng: -73.9397, lat: 40.8002}}\n     */\n    static convert(input                  )               {\n        if (!input || input instanceof LngLatBounds) return input;\n        return new LngLatBounds(input);\n    }\n}\n\n/**\n * A {@link LngLatBounds} object, an array of {@link LngLatLike} objects in [sw, ne] order,\n * or an array of numbers in [west, south, east, north] order.\n *\n * @typedef {LngLatBounds | [LngLatLike, LngLatLike] | [number, number, number, number]} LngLatBoundsLike\n * @example\n * var v1 = new mapboxgl.LngLatBounds(\n *   new mapboxgl.LngLat(-73.9876, 40.7661),\n *   new mapboxgl.LngLat(-73.9397, 40.8002)\n * );\n * var v2 = new mapboxgl.LngLatBounds([-73.9876, 40.7661], [-73.9397, 40.8002])\n * var v3 = [[-73.9876, 40.7661], [-73.9397, 40.8002]];\n */\n                                                                                                          \n\nmodule.exports = LngLatBounds;\n","//      \n\nconst {HTMLImageElement, HTMLCanvasElement, HTMLVideoElement, ImageData} = require('../util/window');\n\n                                         \n                                                         \n\n                           \n                                                  \n                                                    \n                           \n                                                    \n                                                                   \n                                                      \n                         \n                                                    \n                                                           \n                                                              \n\n                   \n                  \n                   \n              \n \n\n                          \n               \n                \n                      \n                       \n                      \n               \n                 \n\nclass Texture {\n                     \n                        \n                          \n                          \n                           \n                       \n\n    constructor(context         , image              , format               , premultiply          ) {\n        this.context = context;\n\n        const {width, height} = image;\n        this.size = [width, height];\n        this.format = format;\n\n        this.texture = context.gl.createTexture();\n        this.update(image, premultiply);\n    }\n\n    update(image              , premultiply          ) {\n        const {width, height} = image;\n        this.size = [width, height];\n\n        const {context} = this;\n        const {gl} = context;\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n        context.pixelStoreUnpack.set(1);\n\n        if (this.format === gl.RGBA && premultiply !== false) {\n            context.pixelStoreUnpackPremultiplyAlpha.set(true);\n        }\n\n        if (image instanceof HTMLImageElement || image instanceof HTMLCanvasElement || image instanceof HTMLVideoElement || image instanceof ImageData) {\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.format, this.format, gl.UNSIGNED_BYTE, image);\n        } else {\n            gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, gl.UNSIGNED_BYTE, image.data);\n        }\n    }\n\n    bind(filter               , wrap             , minFilter                ) {\n        const {context} = this;\n        const {gl} = context;\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\n\n        if (filter !== this.filter) {\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filter);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, minFilter || filter);\n            this.filter = filter;\n        }\n\n        if (wrap !== this.wrap) {\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, wrap);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, wrap);\n            this.wrap = wrap;\n        }\n    }\n\n    destroy() {\n        const {gl} = this.context;\n        gl.deleteTexture(this.texture);\n        this.texture = (null     );\n    }\n}\n\nmodule.exports = Texture;\n","//      \n\nconst LngLatBounds = require('../geo/lng_lat_bounds');\nconst clamp = require('../util/util').clamp;\n\n                                               \n\nclass TileBounds {\n                         \n                    \n                    \n\n    constructor(bounds                                  , minzoom         , maxzoom         ) {\n        this.bounds = LngLatBounds.convert(this.validateBounds(bounds));\n        this.minzoom = minzoom || 0;\n        this.maxzoom = maxzoom || 24;\n    }\n\n    validateBounds(bounds                                  ) {\n        // make sure the bounds property contains valid longitude and latitudes\n        if (!Array.isArray(bounds) || bounds.length !== 4) return [-180, -90, 180, 90];\n        return [Math.max(-180, bounds[0]), Math.max(-90, bounds[1]), Math.min(180, bounds[2]), Math.min(90, bounds[3])];\n    }\n\n    contains(tileID                 ) {\n        const level = {\n            minX: Math.floor(this.lngX(this.bounds.getWest(), tileID.z)),\n            minY: Math.floor(this.latY(this.bounds.getNorth(), tileID.z)),\n            maxX: Math.ceil(this.lngX(this.bounds.getEast(), tileID.z)),\n            maxY: Math.ceil(this.latY(this.bounds.getSouth(), tileID.z))\n        };\n        const hit = tileID.x >= level.minX && tileID.x < level.maxX && tileID.y >= level.minY && tileID.y < level.maxY;\n        return hit;\n    }\n\n    lngX(lng        , zoom        ) {\n        return (lng + 180) * (Math.pow(2, zoom) / 360);\n    }\n\n    latY(lat        , zoom        ) {\n        const f = clamp(Math.sin(Math.PI / 180 * lat), -0.9999, 0.9999);\n        const scale = Math.pow(2, zoom) / (2 * Math.PI);\n        return Math.pow(2, zoom - 1) + 0.5 * Math.log((1 + f) / (1 - f)) * -scale;\n    }\n}\n\nmodule.exports = TileBounds;\n","//      \n\nconst window = require('./window');\n\n                                                  \n\n/**\n * The type of a resource.\n * @private\n * @readonly\n * @enum {string}\n */\nconst ResourceType = {\n    Unknown: 'Unknown',\n    Style: 'Style',\n    Source: 'Source',\n    Tile: 'Tile',\n    Glyphs: 'Glyphs',\n    SpriteImage: 'SpriteImage',\n    SpriteJSON: 'SpriteJSON',\n    Image: 'Image'\n};\nexports.ResourceType = ResourceType;\n\nif (typeof Object.freeze == 'function') {\n    Object.freeze(ResourceType);\n}\n\n/**\n * A `RequestParameters` object to be returned from Map.options.transformRequest callbacks.\n * @typedef {Object} RequestParameters\n * @property {string} url The URL to be requested.\n * @property {Object} headers The headers to be sent with the request.\n * @property {string} credentials `'same-origin'|'include'` Use 'include' to send cookies with cross-origin requests.\n */\n                                 \n                \n                     \n                                           \n  \n\nclass AJAXError extends Error {\n                   \n    constructor(message        , status        ) {\n        super(message);\n        this.status = status;\n    }\n}\n\nfunction makeRequest(requestParameters                   )                 {\n    const xhr                 = new window.XMLHttpRequest();\n\n    xhr.open('GET', requestParameters.url, true);\n    for (const k in requestParameters.headers) {\n        xhr.setRequestHeader(k, requestParameters.headers[k]);\n    }\n    xhr.withCredentials = requestParameters.credentials === 'include';\n    return xhr;\n}\n\nexports.getJSON = function(requestParameters                   , callback                 ) {\n    const xhr = makeRequest(requestParameters);\n    xhr.setRequestHeader('Accept', 'application/json');\n    xhr.onerror = function() {\n        callback(new Error(xhr.statusText));\n    };\n    xhr.onload = function() {\n        if (xhr.status >= 200 && xhr.status < 300 && xhr.response) {\n            let data;\n            try {\n                data = JSON.parse(xhr.response);\n            } catch (err) {\n                return callback(err);\n            }\n            callback(null, data);\n        } else {\n            callback(new AJAXError(xhr.statusText, xhr.status));\n        }\n    };\n    xhr.send();\n    return xhr;\n};\n\nexports.getArrayBuffer = function(requestParameters                   , callback                                                                        ) {\n    const xhr = makeRequest(requestParameters);\n    xhr.responseType = 'arraybuffer';\n    xhr.onerror = function() {\n        callback(new Error(xhr.statusText));\n    };\n    xhr.onload = function() {\n        const response              = xhr.response;\n        if (response.byteLength === 0 && xhr.status === 200) {\n            return callback(new Error('http status 200 returned without content.'));\n        }\n        if (xhr.status >= 200 && xhr.status < 300 && xhr.response) {\n            callback(null, {\n                data: response,\n                cacheControl: xhr.getResponseHeader('Cache-Control'),\n                expires: xhr.getResponseHeader('Expires')\n            });\n        } else {\n            callback(new AJAXError(xhr.statusText, xhr.status));\n        }\n    };\n    xhr.send();\n    return xhr;\n};\n\nfunction sameOrigin(url) {\n    const a                    = window.document.createElement('a');\n    a.href = url;\n    return a.protocol === window.document.location.protocol && a.host === window.document.location.host;\n}\n\nconst transparentPngUrl = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=';\n\nexports.getImage = function(requestParameters                   , callback                            ) {\n    // request the image with XHR to work around caching issues\n    // see https://github.com/mapbox/mapbox-gl-js/issues/1470\n    return exports.getArrayBuffer(requestParameters, (err, imgData) => {\n        if (err) {\n            callback(err);\n        } else if (imgData) {\n            const img                   = new window.Image();\n            const URL = window.URL || window.webkitURL;\n            img.onload = () => {\n                callback(null, img);\n                URL.revokeObjectURL(img.src);\n            };\n            const blob       = new window.Blob([new Uint8Array(imgData.data)], { type: 'image/png' });\n            (img     ).cacheControl = imgData.cacheControl;\n            (img     ).expires = imgData.expires;\n            img.src = imgData.data.byteLength ? URL.createObjectURL(blob) : transparentPngUrl;\n        }\n    });\n};\n\nexports.getVideo = function(urls               , callback                            ) {\n    const video                   = window.document.createElement('video');\n    video.onloadstart = function() {\n        callback(null, video);\n    };\n    for (let i = 0; i < urls.length; i++) {\n        const s                    = window.document.createElement('source');\n        if (!sameOrigin(urls[i])) {\n            video.crossOrigin = 'Anonymous';\n        }\n        s.src = urls[i];\n        video.appendChild(s);\n    }\n    return video;\n};\n","//      \n\nconst window = require('./window');\n\nconst now = window.performance && window.performance.now ?\n    window.performance.now.bind(window.performance) :\n    Date.now.bind(Date);\n\nconst frame = window.requestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.msRequestAnimationFrame;\n\nconst cancel = window.cancelAnimationFrame ||\n    window.mozCancelAnimationFrame ||\n    window.webkitCancelAnimationFrame ||\n    window.msCancelAnimationFrame;\n\n/**\n * @private\n */\nmodule.exports = {\n    /**\n     * Provides a function that outputs milliseconds: either performance.now()\n     * or a fallback to Date.now()\n     */\n    now,\n\n    frame(fn          ) {\n        return frame(fn);\n    },\n\n    cancelFrame(id        ) {\n        return cancel(id);\n    },\n\n    getImageData(img                   )            {\n        const canvas = window.document.createElement('canvas');\n        const context = canvas.getContext('2d');\n        if (!context) {\n            throw new Error('failed to create canvas 2d context');\n        }\n        canvas.width = img.width;\n        canvas.height = img.height;\n        context.drawImage(img, 0, 0, img.width, img.height);\n        return context.getImageData(0, 0, img.width, img.height);\n    },\n\n    hardwareConcurrency: window.navigator.hardwareConcurrency || 4,\n\n    get devicePixelRatio() { return window.devicePixelRatio; },\n\n    supportsWebp: false\n};\n\nconst webpImgTest = window.document.createElement('img');\nwebpImgTest.onload = function() {\n    module.exports.supportsWebp = true;\n};\nwebpImgTest.src = 'data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=';\n","//      \n\n/* eslint-env browser */\nmodule.exports = (self        );\n","//      \n\nconst util = require('./util');\n\n                                \n                                               \n\nfunction _addEventListener(type        , listener          , listenerList           ) {\n    listenerList[type] = listenerList[type] || [];\n    listenerList[type].push(listener);\n}\n\nfunction _removeEventListener(type        , listener          , listenerList           ) {\n    if (listenerList && listenerList[type]) {\n        const index = listenerList[type].indexOf(listener);\n        if (index !== -1) {\n            listenerList[type].splice(index, 1);\n        }\n    }\n}\n\n/**\n * Methods mixed in to other classes for event capabilities.\n *\n * @mixin Evented\n */\nclass Evented {\n                          \n                                 \n                             \n                                                 \n\n    /**\n     * Adds a listener to a specified event type.\n     *\n     * @param {string} type The event type to add a listen for.\n     * @param {Function} listener The function to be called when the event is fired.\n     *   The listener function is called with the data object passed to `fire`,\n     *   extended with `target` and `type` properties.\n     * @returns {Object} `this`\n     */\n    on(type   , listener          )       {\n        this._listeners = this._listeners || {};\n        _addEventListener(type, listener, this._listeners);\n\n        return this;\n    }\n\n    /**\n     * Removes a previously registered event listener.\n     *\n     * @param {string} type The event type to remove listeners for.\n     * @param {Function} listener The listener function to remove.\n     * @returns {Object} `this`\n     */\n    off(type   , listener          ) {\n        _removeEventListener(type, listener, this._listeners);\n        _removeEventListener(type, listener, this._oneTimeListeners);\n\n        return this;\n    }\n\n    /**\n     * Adds a listener that will be called only once to a specified event type.\n     *\n     * The listener will be called first time the event fires after the listener is registered.\n     *\n     * @param {string} type The event type to listen for.\n     * @param {Function} listener The function to be called when the event is fired the first time.\n     * @returns {Object} `this`\n     */\n    once(type        , listener          ) {\n        this._oneTimeListeners = this._oneTimeListeners || {};\n        _addEventListener(type, listener, this._oneTimeListeners);\n\n        return this;\n    }\n\n    /**\n     * Fires an event of the specified type.\n     *\n     * @param {string} type The type of event to fire.\n     * @param {Object} [data] Data to be passed to any listeners.\n     * @returns {Object} `this`\n     */\n    fire(type        , data         ) {\n        if (this.listens(type)) {\n            data = util.extend({}, data, {type: type, target: this});\n\n            // make sure adding or removing listeners inside other listeners won't cause an infinite loop\n            const listeners = this._listeners && this._listeners[type] ? this._listeners[type].slice() : [];\n            for (const listener of listeners) {\n                listener.call(this, data);\n            }\n\n            const oneTimeListeners = this._oneTimeListeners && this._oneTimeListeners[type] ? this._oneTimeListeners[type].slice() : [];\n            for (const listener of oneTimeListeners) {\n                _removeEventListener(type, listener, this._oneTimeListeners);\n                listener.call(this, data);\n            }\n\n            if (this._eventedParent) {\n                this._eventedParent.fire(type, util.extend({}, data, typeof this._eventedParentData === 'function' ? this._eventedParentData() : this._eventedParentData));\n            }\n\n        // To ensure that no error events are dropped, print them to the\n        // console if they have no listeners.\n        } else if (util.endsWith(type, 'error')) {\n            console.error((data && data.error) || data || 'Empty error event');\n        }\n\n        return this;\n    }\n\n    /**\n     * Returns a true if this instance of Evented or any forwardeed instances of Evented have a listener for the specified type.\n     *\n     * @param {string} type The event type\n     * @returns {boolean} `true` if there is at least one registered listener for specified event type, `false` otherwise\n     */\n    listens(type        ) {\n        return (\n            (this._listeners && this._listeners[type] && this._listeners[type].length > 0) ||\n            (this._oneTimeListeners && this._oneTimeListeners[type] && this._oneTimeListeners[type].length > 0) ||\n            (this._eventedParent && this._eventedParent.listens(type))\n        );\n    }\n\n    /**\n     * Bubble all events fired by this instance of Evented to this parent instance of Evented.\n     *\n     * @private\n     * @returns {Object} `this`\n     */\n    setEventedParent(parent          , data                        ) {\n        this._eventedParent = parent;\n        this._eventedParentData = data;\n\n        return this;\n    }\n}\n\nmodule.exports = Evented;\n","//      \n\nconst UnitBezier = require('@mapbox/unitbezier');\nconst Coordinate = require('../geo/coordinate');\nconst Point = require('@mapbox/point-geometry');\n\n                                                \n\n/**\n * @module util\n * @private\n */\n\n/**\n * Given a value `t` that varies between 0 and 1, return\n * an interpolation function that eases between 0 and 1 in a pleasing\n * cubic in-out fashion.\n *\n * @private\n */\nexports.easeCubicInOut = function(t        )         {\n    if (t <= 0) return 0;\n    if (t >= 1) return 1;\n    const t2 = t * t,\n        t3 = t2 * t;\n    return 4 * (t < 0.5 ? t3 : 3 * (t - t2) + t3 - 0.75);\n};\n\n/**\n * Given given (x, y), (x1, y1) control points for a bezier curve,\n * return a function that interpolates along that curve.\n *\n * @param p1x control point 1 x coordinate\n * @param p1y control point 1 y coordinate\n * @param p2x control point 2 x coordinate\n * @param p2y control point 2 y coordinate\n * @private\n */\nexports.bezier = function(p1x        , p1y        , p2x        , p2y        )                        {\n    const bezier = new UnitBezier(p1x, p1y, p2x, p2y);\n    return function(t        ) {\n        return bezier.solve(t);\n    };\n};\n\n/**\n * A default bezier-curve powered easing function with\n * control points (0.25, 0.1) and (0.25, 1)\n *\n * @private\n */\nexports.ease = exports.bezier(0.25, 0.1, 0.25, 1);\n\n/**\n * constrain n to the given range via min + max\n *\n * @param n value\n * @param min the minimum value to be returned\n * @param max the maximum value to be returned\n * @returns the clamped value\n * @private\n */\nexports.clamp = function (n        , min        , max        )         {\n    return Math.min(max, Math.max(min, n));\n};\n\n/**\n * constrain n to the given range, excluding the minimum, via modular arithmetic\n *\n * @param n value\n * @param min the minimum value to be returned, exclusive\n * @param max the maximum value to be returned, inclusive\n * @returns constrained number\n * @private\n */\nexports.wrap = function (n        , min        , max        )         {\n    const d = max - min;\n    const w = ((n - min) % d + d) % d + min;\n    return (w === min) ? max : w;\n};\n\n/*\n * Call an asynchronous function on an array of arguments,\n * calling `callback` with the completed results of all calls.\n *\n * @param array input to each call of the async function.\n * @param fn an async function with signature (data, callback)\n * @param callback a callback run after all async work is done.\n * called with an array, containing the results of each async call.\n * @private\n */\nexports.asyncAll = function               (\n    array             ,\n    fn                                                    ,\n    callback                         \n) {\n    if (!array.length) { return callback(null, []); }\n    let remaining = array.length;\n    const results = new Array(array.length);\n    let error = null;\n    array.forEach((item, i) => {\n        fn(item, (err, result) => {\n            if (err) error = err;\n            results[i] = ((result     )        ); // https://github.com/facebook/flow/issues/2123\n            if (--remaining === 0) callback(error, results);\n        });\n    });\n};\n\n/*\n * Polyfill for Object.values. Not fully spec compliant, but we don't\n * need it to be.\n *\n * @private\n */\nexports.values = function   (obj                    )           {\n    const result = [];\n    for (const k in obj) {\n        result.push(obj[k]);\n    }\n    return result;\n};\n\n/*\n * Compute the difference between the keys in one object and the keys\n * in another object.\n *\n * @returns keys difference\n * @private\n */\nexports.keysDifference = function      (obj                    , other                    )                {\n    const difference = [];\n    for (const i in obj) {\n        if (!(i in other)) {\n            difference.push(i);\n        }\n    }\n    return difference;\n};\n\n/**\n * Given a destination object and optionally many source objects,\n * copy all properties from the source objects into the destination.\n * The last source object given overrides properties from previous\n * source objects.\n *\n * @param dest destination object\n * @param sources sources from which properties are pulled\n * @private\n */\nexports.extend = function (dest        , ...sources                )         {\n    for (const src of sources) {\n        for (const k in src) {\n            dest[k] = src[k];\n        }\n    }\n    return dest;\n};\n\n/**\n * Given an object and a number of properties as strings, return version\n * of that object with only those properties.\n *\n * @param src the object\n * @param properties an array of property names chosen\n * to appear on the resulting object.\n * @returns object with limited properties.\n * @example\n * var foo = { name: 'Charlie', age: 10 };\n * var justName = pick(foo, ['name']);\n * // justName = { name: 'Charlie' }\n * @private\n */\nexports.pick = function (src        , properties               )         {\n    const result = {};\n    for (let i = 0; i < properties.length; i++) {\n        const k = properties[i];\n        if (k in src) {\n            result[k] = src[k];\n        }\n    }\n    return result;\n};\n\nlet id = 1;\n\n/**\n * Return a unique numeric id, starting at 1 and incrementing with\n * each call.\n *\n * @returns unique numeric id.\n * @private\n */\nexports.uniqueId = function ()         {\n    return id++;\n};\n\n/**\n * Given an array of member function names as strings, replace all of them\n * with bound versions that will always refer to `context` as `this`. This\n * is useful for classes where otherwise event bindings would reassign\n * `this` to the evented object or some other value: this lets you ensure\n * the `this` value always.\n *\n * @param fns list of member function names\n * @param context the context value\n * @example\n * function MyClass() {\n *   bindAll(['ontimer'], this);\n *   this.name = 'Tom';\n * }\n * MyClass.prototype.ontimer = function() {\n *   alert(this.name);\n * };\n * var myClass = new MyClass();\n * setTimeout(myClass.ontimer, 100);\n * @private\n */\nexports.bindAll = function(fns               , context        )       {\n    fns.forEach((fn) => {\n        if (!context[fn]) { return; }\n        context[fn] = context[fn].bind(context);\n    });\n};\n\n/**\n * Given a list of coordinates, get their center as a coordinate.\n *\n * @returns centerpoint\n * @private\n */\nexports.getCoordinatesCenter = function(coords                   )             {\n    let minX = Infinity;\n    let minY = Infinity;\n    let maxX = -Infinity;\n    let maxY = -Infinity;\n\n    for (let i = 0; i < coords.length; i++) {\n        minX = Math.min(minX, coords[i].column);\n        minY = Math.min(minY, coords[i].row);\n        maxX = Math.max(maxX, coords[i].column);\n        maxY = Math.max(maxY, coords[i].row);\n    }\n\n    const dx = maxX - minX;\n    const dy = maxY - minY;\n    const dMax = Math.max(dx, dy);\n    const zoom = Math.max(0, Math.floor(-Math.log(dMax) / Math.LN2));\n    return new Coordinate((minX + maxX) / 2, (minY + maxY) / 2, 0)\n        .zoomTo(zoom);\n};\n\n/**\n * Determine if a string ends with a particular substring\n *\n * @private\n */\nexports.endsWith = function(string        , suffix        )          {\n    return string.indexOf(suffix, string.length - suffix.length) !== -1;\n};\n\n/**\n * Create an object by mapping all the values of an existing object while\n * preserving their keys.\n *\n * @private\n */\nexports.mapObject = function(input        , iterator          , context         )         {\n    const output = {};\n    for (const key in input) {\n        output[key] = iterator.call(context || this, input[key], key, input);\n    }\n    return output;\n};\n\n/**\n * Create an object by filtering out values of an existing object.\n *\n * @private\n */\nexports.filterObject = function(input        , iterator          , context         )         {\n    const output = {};\n    for (const key in input) {\n        if (iterator.call(context || this, input[key], key, input)) {\n            output[key] = input[key];\n        }\n    }\n    return output;\n};\n\n/**\n * Deeply compares two object literals.\n *\n * @private\n */\nexports.deepEqual = function(a        , b        )          {\n    if (Array.isArray(a)) {\n        if (!Array.isArray(b) || a.length !== b.length) return false;\n        for (let i = 0; i < a.length; i++) {\n            if (!exports.deepEqual(a[i], b[i])) return false;\n        }\n        return true;\n    }\n    if (typeof a === 'object' && a !== null && b !== null) {\n        if (!(typeof b === 'object')) return false;\n        const keys = Object.keys(a);\n        if (keys.length !== Object.keys(b).length) return false;\n        for (const key in a) {\n            if (!exports.deepEqual(a[key], b[key])) return false;\n        }\n        return true;\n    }\n    return a === b;\n};\n\n/**\n * Deeply clones two objects.\n *\n * @private\n */\nexports.clone = function   (input   )    {\n    if (Array.isArray(input)) {\n        return input.map(exports.clone);\n    } else if (typeof input === 'object' && input) {\n        return ((exports.mapObject(input, exports.clone)     )   );\n    } else {\n        return input;\n    }\n};\n\n/**\n * Check if two arrays have at least one common element.\n *\n * @private\n */\nexports.arraysIntersect = function   (a          , b          )          {\n    for (let l = 0; l < a.length; l++) {\n        if (b.indexOf(a[l]) >= 0) return true;\n    }\n    return false;\n};\n\n/**\n * Print a warning message to the console and ensure duplicate warning messages\n * are not printed.\n *\n * @private\n */\nconst warnOnceHistory                           = {};\nexports.warnOnce = function(message        )       {\n    if (!warnOnceHistory[message]) {\n        // console isn't defined in some WebWorkers, see #2558\n        if (typeof console !== \"undefined\") console.warn(message);\n        warnOnceHistory[message] = true;\n    }\n};\n\n/**\n * Indicates if the provided Points are in a counter clockwise (true) or clockwise (false) order\n *\n * @returns true for a counter clockwise set of points\n */\n// http://bryceboe.com/2006/10/23/line-segment-intersection-algorithm/\nexports.isCounterClockwise = function(a       , b       , c       )          {\n    return (c.y - a.y) * (b.x - a.x) > (b.y - a.y) * (c.x - a.x);\n};\n\n/**\n * Returns the signed area for the polygon ring.  Postive areas are exterior rings and\n * have a clockwise winding.  Negative areas are interior rings and have a counter clockwise\n * ordering.\n *\n * @param ring Exterior or interior ring\n */\nexports.calculateSignedArea = function(ring              )         {\n    let sum = 0;\n    for (let i = 0, len = ring.length, j = len - 1, p1, p2; i < len; j = i++) {\n        p1 = ring[i];\n        p2 = ring[j];\n        sum += (p2.x - p1.x) * (p1.y + p2.y);\n    }\n    return sum;\n};\n\n/**\n * Detects closed polygons, first + last point are equal\n *\n * @param points array of points\n * @return true if the points are a closed polygon\n */\nexports.isClosedPolygon = function(points              )          {\n    // If it is 2 points that are the same then it is a point\n    // If it is 3 points with start and end the same then it is a line\n    if (points.length < 4)\n        return false;\n\n    const p1 = points[0];\n    const p2 = points[points.length - 1];\n\n    if (Math.abs(p1.x - p2.x) > 0 ||\n        Math.abs(p1.y - p2.y) > 0) {\n        return false;\n    }\n\n    // polygon simplification can produce polygons with zero area and more than 3 points\n    return (Math.abs(exports.calculateSignedArea(points)) > 0.01);\n};\n\n/**\n * Converts spherical coordinates to cartesian coordinates.\n *\n * @param spherical Spherical coordinates, in [radial, azimuthal, polar]\n * @return cartesian coordinates in [x, y, z]\n */\n\nexports.sphericalToCartesian = function([r, azimuthal, polar]                          )                                    {\n    // We abstract \"north\"/\"up\" (compass-wise) to be 0° when really this is 90° (π/2):\n    // correct for that here\n    azimuthal += 90;\n\n    // Convert azimuthal and polar angles to radians\n    azimuthal *= Math.PI / 180;\n    polar *= Math.PI / 180;\n\n    return {\n        x: r * Math.cos(azimuthal) * Math.sin(polar),\n        y: r * Math.sin(azimuthal) * Math.sin(polar),\n        z: r * Math.cos(polar)\n    };\n};\n\n/**\n * Parses data from 'Cache-Control' headers.\n *\n * @param cacheControl Value of 'Cache-Control' header\n * @return object containing parsed header info.\n */\n\nexports.parseCacheControl = function(cacheControl        )         {\n    // Taken from [Wreck](https://github.com/hapijs/wreck)\n    const re = /(?:^|(?:\\s*\\,\\s*))([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)(?:\\=(?:([^\\x00-\\x20\\(\\)<>@\\,;\\:\\\\\"\\/\\[\\]\\?\\=\\{\\}\\x7F]+)|(?:\\\"((?:[^\"\\\\]|\\\\.)*)\\\")))?/g;\n\n    const header = {};\n    cacheControl.replace(re, ($0, $1, $2, $3) => {\n        const value = $2 || $3;\n        header[$1] = value ? value.toLowerCase() : true;\n        return '';\n    });\n\n    if (header['max-age']) {\n        const maxAge = parseInt(header['max-age'], 10);\n        if (isNaN(maxAge)) delete header['max-age'];\n        else header['max-age'] = maxAge;\n    }\n\n    return header;\n};\n","//      \n\nconst util = require('mapbox-gl/src/util/util');\nconst ajax = require('mapbox-gl/src/util/ajax');\nconst Evented = require('mapbox-gl/src/util/evented');\nconst loadArcGISMapServer = require('./load_arcgis_mapserver');\nconst TileBounds = require('mapbox-gl/src/source/tile_bounds');\nconst Texture = require('mapbox-gl/src/render/texture');\nconst helpers = require('./helpers');\n\n                                                        \n                                                                   \n                                            \n                                                            \n                                                  \n                                                           \n\nclass ArcGISTiledMapServiceSource extends Evented                   {\n\n                                  \n               \n                    \n                    \n                \n                   \n                     \n\n                                              \n                           \n                       \n                           \n             \n                         \n\n                     \n                                                                       \n\n    constructor(id        , options                                                          , dispatcher            , eventedParent         ) {\n        super();\n        this.id = id;\n        this.dispatcher = dispatcher;\n        this.setEventedParent(eventedParent);\n\n        this.type = 'arcgisraster';\n        this.minzoom = 0;\n        this.maxzoom = 22;\n        this.roundZoom = true;\n        this.tileSize = 512;\n        this._loaded = false;\n\n        this._options = util.extend({}, options);\n        util.extend(this, util.pick(options, ['url', 'scheme', 'tileSize']));\n    }\n\n    load() {\n        this.fire('dataloading', {dataType: 'source'});\n        loadArcGISMapServer(this._options, (err, metadata) => {\n            if (err) {\n                this.fire('error', err);\n            } else if (metadata) {\n                util.extend(this, metadata);\n\n                if (metadata.bounds) {\n                    this.tileBounds = new TileBounds(metadata.bounds, this.minzoom, this.maxzoom);\n                }\n\n            // `content` is included here to prevent a race condition where `Style#_updateSources` is called\n            // before the TileJSON arrives. this makes sure the tiles needed are loaded once TileJSON arrives\n            // ref: https://github.com/mapbox/mapbox-gl-js/pull/4347#discussion_r104418088\n            this.fire('data', {dataType: 'source', sourceDataType: 'metadata'});\n            this.fire('data', {dataType: 'source', sourceDataType: 'content'});\n            }\n        });\n    }\n\n    onAdd(map     ) {\n        // set the urls\n        const baseUrl = this.url.split('?')[0];\n        this.tileUrl = `${baseUrl}/tile/{z}/{y}/{x}`;\n\n        const arcgisonline = new RegExp(/tiles.arcgis(online)?\\.com/g);\n        if (arcgisonline.test(this.url)) {\n            this.tileUrl = this.tileUrl.replace('://tiles', '://tiles{s}');\n            this.subdomains = ['1', '2', '3', '4'];\n        }\n\n        if (this.token) {\n            this.tileUrl += (`?token=${this.token}`);\n        }\n        \n        this.map = map;\n        this.load();\n    }\n\n    serialize() {\n        return util.extend({}, this._options);\n    }\n\n    hasTile(tileID                  ) {\n        return !this.tileBounds || this.tileBounds.contains(tileID.canonical);\n    }\n\n    loadTile(tile      , callback                ) {\n        //convert to ags coords\n        const tilePoint = { z: tile.tileID.overscaledZ, x: tile.tileID.canonical.x, y: tile.tileID.canonical.y };\n\n        const url =  helpers._template(this.tileUrl, util.extend({\n            s: helpers._getSubdomain(tilePoint, this.subdomains),\n            z: (this._lodMap && this._lodMap[tilePoint.z]) ? this._lodMap[tilePoint.z] : tilePoint.z, // try lod map first, then just defualt to zoom level\n            x: tilePoint.x,\n            y: tilePoint.y\n        }, this.options));\n        tile.request = ajax.getImage({url},  (err, img) => {\n            delete tile.request;\n\n            if (tile.aborted) {\n                tile.state = 'unloaded';\n                callback(null);\n            } else if (err) {\n                tile.state = 'errored';\n                callback(err);\n            } else if (img) {\n                if (this.map._refreshExpiredTiles) tile.setExpiryData(img);\n                delete (img     ).cacheControl;\n                delete (img     ).expires;\n\n                const context = this.map.painter.context;\n                const gl = context.gl;\n                tile.texture = this.map.painter.getTileTexture(img.width);\n                if (tile.texture) {\n                    tile.texture.bind(gl.LINEAR, gl.CLAMP_TO_EDGE, gl.LINEAR_MIPMAP_NEAREST);\n                    gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, gl.RGBA, gl.UNSIGNED_BYTE, img);\n                } else {\n                    tile.texture = new Texture(context, img, gl.RGBA);\n                    tile.texture.bind(gl.LINEAR, gl.CLAMP_TO_EDGE, gl.LINEAR_MIPMAP_NEAREST);\n\n                    if (context.extTextureFilterAnisotropic) {\n                        gl.texParameterf(gl.TEXTURE_2D, context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, context.extTextureFilterAnisotropicMax);\n                    }\n                }\n                gl.generateMipmap(gl.TEXTURE_2D);\n\n                tile.state = 'loaded';\n\n                callback(null);\n            }\n        });\n    }\n\n    abortTile(tile      , callback                ) {\n        if (tile.request) {\n            tile.request.abort();\n            delete tile.request;\n        }\n        callback();\n    }\n\n    unloadTile(tile      , callback                ) {\n        if (tile.texture) this.map.painter.saveTileTexture(tile.texture);\n        callback();\n    }\n\n    hasTransition() {\n        return false;\n    }\n}\n\nmodule.exports = ArcGISTiledMapServiceSource;","\n//From https://github.com/Leaflet/Leaflet/blob/master/src/core/Util.js\nconst _templateRe = /\\{ *([\\w_]+) *\\}/g;\nconst _template = function (str, data) {\n    return str.replace(_templateRe, (str, key) => {\n        let value = data[key];\n\n        if (value === undefined) {\n            throw new Error(`No value provided for variable ${str}`);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n};\n\n//From https://github.com/Leaflet/Leaflet/blob/master/src/layer/tile/TileLayer.js\nconst _getSubdomain = function (tilePoint, subdomains) {\n    if (subdomains) {\n        const index = Math.abs(tilePoint.x + tilePoint.y) % subdomains.length;\n        return subdomains[index];\n    }\n    return null;\n};\n\nmodule.exports = {\n    _template,\n    _getSubdomain\n};\n","const ArcGISTiledMapServiceSource = require('./arcgis_tiled_map_service_source');\nmodule.exports = ArcGISTiledMapServiceSource;","'use strict';\nconst util = require('mapbox-gl/src/util/util');\nconst ajax = require('mapbox-gl/src/util/ajax');\nconst browser = require('mapbox-gl/src/util/browser');\nconst SphericalMercator = require('@mapbox/sphericalmercator');\n\n//Contains code from esri-leaflet https://github.com/Esri/esri-leaflet\nconst MercatorZoomLevels = {\n    '0': 156543.03392799999,\n    '1': 78271.516963999893,\n    '2': 39135.758482000099,\n    '3': 19567.879240999901,\n    '4': 9783.9396204999593,\n    '5': 4891.9698102499797,\n    '6': 2445.9849051249898,\n    '7': 1222.9924525624899,\n    '8': 611.49622628138002,\n    '9': 305.74811314055802,\n    '10': 152.874056570411,\n    '11': 76.437028285073197,\n    '12': 38.218514142536598,\n    '13': 19.109257071268299,\n    '14': 9.5546285356341496,\n    '15': 4.7773142679493699,\n    '16': 2.38865713397468,\n    '17': 1.1943285668550501,\n    '18': 0.59716428355981699,\n    '19': 0.29858214164761698,\n    '20': 0.14929107082381,\n    '21': 0.07464553541191,\n    '22': 0.0373227677059525,\n    '23': 0.0186613838529763\n};\n\nconst _withinPercentage = function (a, b, percentage) {\n    const diff = Math.abs((a / b) - 1);\n    return diff < percentage;\n};\n\nmodule.exports = function(options, callback) {\n    const loaded = function(err, metadata) {\n        if (err) {\n            return callback(err);\n        }\n\n        const result = util.pick(metadata,\n            ['tileInfo', 'initialExtent', 'fullExtent', 'spatialReference', 'tileServers', 'documentInfo']);\n\n        result._lodMap = {};\n        const zoomOffsetAllowance = 0.1;\n        const sr = metadata.spatialReference.latestWkid || metadata.spatialReference.wkid;\n        if (sr === 102100 || sr === 3857) {\n\n            /*\n            Example extent from ArcGIS REST API\n            fullExtent: {\n            xmin: -9144791.679226127,\n            ymin: -2195190.961437726,\n            xmax: -4650987.072019983,\n            ymax: 1118113.110155766,\n            spatialReference: {\n            wkid: 102100,\n            wkt: null\n            }\n            },\n            */\n            //convert ArcGIS extent to bounds\n            const extent = metadata.fullExtent;\n            if (extent && extent.spatialReference && extent.spatialReference.wkid ===  102100) {\n                const boundsWebMercator = [extent.xmin, extent.ymin, extent.xmax, extent.ymax];\n                var merc = new SphericalMercator({\n                    size: 256\n                });\n                const boundsWGS84 = merc.convert(boundsWebMercator);\n                result.bounds = boundsWGS84;\n            }\n\n            // create the zoom level data\n            const arcgisLODs = metadata.tileInfo.lods;\n            const correctResolutions = MercatorZoomLevels;\n            result.minzoom = arcgisLODs[0].level;\n            result.maxzoom = arcgisLODs[arcgisLODs.length - 1].level;\n            for (let i = 0; i < arcgisLODs.length; i++) {\n                const arcgisLOD = arcgisLODs[i];\n                for (const ci in correctResolutions) {\n                    const correctRes = correctResolutions[ci];\n\n                    if (_withinPercentage(arcgisLOD.resolution, correctRes, zoomOffsetAllowance)) {\n                        result._lodMap[ci] = arcgisLOD.level;\n                        break;\n                    }\n                }\n            }\n        } else {\n            callback(new Error('non-mercator spatial reference'));\n        }\n\n        callback(null, result);\n    };\n\n    if (options.url) {\n        ajax.getJSON({url: options.url}, loaded);\n    } else {\n        browser.frame(loaded.bind(null, null, options));\n    }\n};\n"]}